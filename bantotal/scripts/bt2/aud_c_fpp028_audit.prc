CREATE OR REPLACE PROCEDURE AUD_C_FPP028_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FPP028_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'FPP028',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PP010PRD=', RTRIM(COALESCE(AUD_old_PP010PRD,AUD_new_PP010PRD)) ),CONCAT( '|PP017PAR=', RTRIM(COALESCE(AUD_old_PP017PAR,AUD_new_PP017PAR)) ) ),CONCAT( '|PP028EMP=', RTRIM(COALESCE(AUD_old_PP028EMP,AUD_new_PP028EMP)) ) ),CONCAT( '|PP028MDA=', RTRIM(COALESCE(AUD_old_PP028MDA,AUD_new_PP028MDA)) ) ),CONCAT( '|PP028MOD=', RTRIM(COALESCE(AUD_old_PP028MOD,AUD_new_PP028MOD)) ) ),CONCAT( '|PP028PAP=', RTRIM(COALESCE(AUD_old_PP028PAP,AUD_new_PP028PAP)) ) ),CONCAT( '|PP028TOP=', RTRIM(COALESCE(AUD_old_PP028TOP,AUD_new_PP028TOP)) ) ),'|' ),AUD_FPP028_UBT,AUD_FPP028_UBU,AUD_FPP028_UBM,AUD_FPP028_UBP,AUD_FPP028_UBR,AUD_FPP028_UAs,AUD_FPP028_UBC,AUD_FPP028_UBA,AUD_FPP028_UBS, '', 'BANTOTAL', '', '', '',AUD_FPP028_UT FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP010PRD',AUD_old_PP010PRD,AUD_new_PP010PRD FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP010PRD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP017PAR',AUD_old_PP017PAR,AUD_new_PP017PAR FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP017PAR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028AUX1',AUD_old_PP028AUX1,AUD_new_PP028AUX1 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028AUX1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028AUX3',TO_CHAR(AUD_old_PP028AUX3,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP028AUX3,'YYYY-MM-DD') FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028AUX3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028AUX4',AUD_old_PP028AUX4,AUD_new_PP028AUX4 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028AUX4'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028AUX5',AUD_old_PP028AUX5,AUD_new_PP028AUX5 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028AUX5'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028CAR1',AUD_old_PP028CAR1,AUD_new_PP028CAR1 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028CAR1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028CAR2',AUD_old_PP028CAR2,AUD_new_PP028CAR2 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028CAR2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028CAR3',AUD_old_PP028CAR3,AUD_new_PP028CAR3 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFl
d = 'PP028CAR3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028DEFC',AUD_old_PP028DEFC,AUD_new_PP028DEFC FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028DEFC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028DEFD',TO_CHAR(AUD_old_PP028DEFD,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP028DEFD,'YYYY-MM-DD') FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028DEFD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028DEFN',AUD_old_PP028DEFN,AUD_new_PP028DEFN FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028DEFN'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028DEFV',AUD_old_PP028DEFV,AUD_new_PP028DEFV FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028DEFV'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028EMP',AUD_old_PP028EMP,AUD_new_PP028EMP FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028EMP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028MAXN',AUD_old_PP028MAXN,AUD_new_PP028MAXN FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028MAXN'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028MDA',AUD_old_PP028MDA,AUD_new_PP028MDA FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028MINN',AUD_old_PP028MINN,AUD_new_PP028MINN FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028MINN'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028MOD',AUD_old_PP028MOD,AUD_new_PP028MOD FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028MOD1',AUD_old_PP028MOD1,AUD_new_PP028MOD1 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028MOD1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028MOD2',AUD_old_PP028MOD2,AUD_new_PP028MOD2 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028MOD2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028MOD3',AUD_old_PP028MOD3,AUD_new_PP028MOD3 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028MOD3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028PAP',AUD_old_PP028PAP,AUD_new_PP028PAP FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028TIPOS',AUD_old_PP028TIPOS,AUD_new_PP028TIPOS FROM BANTPROD.AUD_FPP028_
AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028TIPOS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028TOP',AUD_old_PP028TOP,AUD_new_PP028TOP FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028TOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028VIS1',AUD_old_PP028VIS1,AUD_new_PP028VIS1 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028VIS1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028VIS2',AUD_old_PP028VIS2,AUD_new_PP028VIS2 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028VIS2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP028VIS3',AUD_old_PP028VIS3,AUD_new_PP028VIS3 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP028VIS3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP028_UOn,AUD_FPP028_GuidKey,'PP033AUX2',AUD_old_PP033AUX2,AUD_new_PP033AUX2 FROM BANTPROD.AUD_FPP028_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey AND AUDMstFld = 'PP033AUX2'); DELETE FROM AUD_FPP028_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP028_UOn AND AUDMstId = AUD_FPP028_GuidKey);  COMMIT ;END IF;END;
/

