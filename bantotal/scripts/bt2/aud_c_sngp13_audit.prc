CREATE OR REPLACE PROCEDURE AUD_C_SNGP13_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_SNGP13_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|SNGP10MOD=', RTRIM(COALESCE(AUD_old_SNGP10MOD,AUD_new_SNGP10MOD)) ),CONCAT( '|SNGP10PGC=', RTRIM(COALESCE(AUD_old_SNGP10PGC,AUD_new_SNGP10PGC)) ) ),CONCAT( '|SNGP10TOPE=', RTRIM(COALESCE(AUD_old_SNGP10TOPE,AUD_new_SNGP10TOPE)) ) ),CONCAT( '|SNGP13COD=', RTRIM(COALESCE(AUD_old_SNGP13COD,AUD_new_SNGP13COD)) ) ),CONCAT( '|SNGP13EXCL=', RTRIM(COALESCE(AUD_old_SNGP13EXCL,AUD_new_SNGP13EXCL)) ) ),'|' ),AUD_SNGP13_UBT,AUD_SNGP13_UBU,AUD_SNGP13_UBM,AUD_SNGP13_UBP,AUD_SNGP13_UBR,AUD_SNGP13_UAs,AUD_SNGP13_UBC,AUD_SNGP13_UBA,AUD_SNGP13_UBS, '', 'BANTOTAL', '', '', '',AUD_SNGP13_UT FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP10MOD',AUD_old_SNGP10MOD,AUD_new_SNGP10MOD FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP10MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP10PGC',AUD_old_SNGP10PGC,AUD_new_SNGP10PGC FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP10PGC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP10TOPE',AUD_old_SNGP10TOPE,AUD_new_SNGP10TOPE FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP10TOPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13CHR1',AUD_old_SNGP13CHR1,AUD_new_SNGP13CHR1 FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13CHR1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13COD',AUD_old_SNGP13COD,AUD_new_SNGP13COD FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13EXCL',AUD_old_SNGP13EXCL,AUD_new_SNGP13EXCL FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13EXCL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13LTC1',AUD_old_SNGP13LTC1,AUD_new_SNGP13LTC1 FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13LTC1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13LTC2',AUD_old_SNGP13LTC2,AUD_new_SNGP13LTC2 FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13LTC2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13PGM1',AUD_old_SNGP13PGM1,AUD_new_SNGP13PGM1 FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13PGM1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13PGM2',AUD_old_SNGP13PGM2,AUD_new_SNGP13PGM2 FROM BANTPROD.AUD_SNGP1
3_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13PGM2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13RNGC',AUD_old_SNGP13RNGC,AUD_new_SNGP13RNGC FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13RNGC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13WPN1',AUD_old_SNGP13WPN1,AUD_new_SNGP13WPN1 FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13WPN1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP13_UOn,AUD_SNGP13_GuidKey,'SNGP13WPN2',AUD_old_SNGP13WPN2,AUD_new_SNGP13WPN2 FROM BANTPROD.AUD_SNGP13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey AND AUDMstFld = 'SNGP13WPN2'); DELETE FROM AUD_SNGP13_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGP13_UOn AND AUDMstId = AUD_SNGP13_GuidKey);  COMMIT ;END IF;END;
/

