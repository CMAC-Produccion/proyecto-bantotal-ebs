CREATE OR REPLACE PROCEDURE AUD_C_SNGC60_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_SNGC60_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|SNGC60CORR=', RTRIM(COALESCE(AUD_old_SNGC60CORR,AUD_new_SNGC60CORR)) ),CONCAT( '|SNGC60NDOC=', RTRIM(COALESCE(AUD_old_SNGC60NDOC,AUD_new_SNGC60NDOC)) ) ),CONCAT( '|SNGC60PAIS=', RTRIM(COALESCE(AUD_old_SNGC60PAIS,AUD_new_SNGC60PAIS)) ) ),CONCAT( '|SNGC60TDOC=', RTRIM(COALESCE(AUD_old_SNGC60TDOC,AUD_new_SNGC60TDOC)) ) ),'|' ),AUD_SNGC60_UBT,AUD_SNGC60_UBU,AUD_SNGC60_UBM,AUD_SNGC60_UBP,AUD_SNGC60_UBR,AUD_SNGC60_UAs,AUD_SNGC60_UBC,AUD_SNGC60_UBA,AUD_SNGC60_UBS, '', 'BANTOTAL', '', '', '',AUD_SNGC60_UT FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60ACTE',AUD_old_SNGC60ACTE,AUD_new_SNGC60ACTE FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60ACTE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60AUX1',AUD_old_SNGC60AUX1,AUD_new_SNGC60AUX1 FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60AUX1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60AUX2',TO_CHAR(AUD_old_SNGC60AUX2,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNGC60AUX2,'YYYY-MM-DD') FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60AUX2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60AUX3',AUD_old_SNGC60AUX3,AUD_new_SNGC60AUX3 FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60AUX3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60AUX4',AUD_old_SNGC60AUX4,AUD_new_SNGC60AUX4 FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60AUX4'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60AUX5',AUD_old_SNGC60AUX5,AUD_new_SNGC60AUX5 FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60AUX5'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60CORR',AUD_old_SNGC60CORR,AUD_new_SNGC60CORR FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60CORR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60ERUT',AUD_old_SNGC60ERUT,AUD_new_SNGC60ERUT FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60ERUT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60FINE',TO_CHAR(AUD_old_SNGC60FINE,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNGC60FINE,'YYYY-MM-DD') FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60FINE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60FINI',TO_CHAR(AUD_old_SNGC60FINI,'YYYY-MM-DD'),TO
_CHAR(AUD_new_SNGC60FINI,'YYYY-MM-DD') FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60FINI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60NDOC',AUD_old_SNGC60NDOC,AUD_new_SNGC60NDOC FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60NDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60NOME',AUD_old_SNGC60NOME,AUD_new_SNGC60NOME FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60NOME'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60OCUP',AUD_old_SNGC60OCUP,AUD_new_SNGC60OCUP FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60OCUP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60PAIS',AUD_old_SNGC60PAIS,AUD_new_SNGC60PAIS FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60PAIS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60RUTE',AUD_old_SNGC60RUTE,AUD_new_SNGC60RUTE FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60RUTE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60RUTP',AUD_old_SNGC60RUTP,AUD_new_SNGC60RUTP FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60RUTP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60RZSO',AUD_old_SNGC60RZSO,AUD_new_SNGC60RZSO FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60RZSO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60TDOC',AUD_old_SNGC60TDOC,AUD_new_SNGC60TDOC FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60TDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60TIPA',AUD_old_SNGC60TIPA,AUD_new_SNGC60TIPA FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60TIPA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60UBIC',AUD_old_SNGC60UBIC,AUD_new_SNGC60UBIC FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60UBIC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC60_UOn,AUD_SNGC60_GuidKey,'SNGC60VCOD',AUD_old_SNGC60VCOD,AUD_new_SNGC60VCOD FROM BANTPROD.AUD_SNGC60_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey AND AUDMstFld = 'SNGC60VCOD'); DELETE FROM AUD_SNGC60_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGC60_UOn AND AUDMstId = AUD_SNGC60_GuidKey);  COMMIT ;END IF;END;
/

