CREATE OR REPLACE PROCEDURE AUD_C_SNGC13_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_SNGC13_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|DOCOD=', RTRIM(COALESCE(AUD_old_DOCOD,AUD_new_DOCOD)) ),CONCAT( '|SNGC13CORR=', RTRIM(COALESCE(AUD_old_SNGC13CORR,AUD_new_SNGC13CORR)) ) ),CONCAT( '|SNGC13NDOC=', RTRIM(COALESCE(AUD_old_SNGC13NDOC,AUD_new_SNGC13NDOC)) ) ),CONCAT( '|SNGC13PAIS=', RTRIM(COALESCE(AUD_old_SNGC13PAIS,AUD_new_SNGC13PAIS)) ) ),CONCAT( '|SNGC13TDOC=', RTRIM(COALESCE(AUD_old_SNGC13TDOC,AUD_new_SNGC13TDOC)) ) ),'|' ),AUD_SNGC13_UBT,AUD_SNGC13_UBU,AUD_SNGC13_UBM,AUD_SNGC13_UBP,AUD_SNGC13_UBR,AUD_SNGC13_UAs,AUD_SNGC13_UBC,AUD_SNGC13_UBA,AUD_SNGC13_UBS, '', 'BANTOTAL', '', '', '',AUD_SNGC13_UT FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'DOCOD',AUD_old_DOCOD,AUD_new_DOCOD FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'DOCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC01ID',AUD_old_SNGC01ID,AUD_new_SNGC01ID FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC01ID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC02ID',AUD_old_SNGC02ID,AUD_new_SNGC02ID FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC02ID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC03ID',AUD_old_SNGC03ID,AUD_new_SNGC03ID FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC03ID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC04ID',AUD_old_SNGC04ID,AUD_new_SNGC04ID FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC04ID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC05ID',AUD_old_SNGC05ID,AUD_new_SNGC05ID FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC05ID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC06ID',AUD_old_SNGC06ID,AUD_new_SNGC06ID FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC06ID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC12VIVC',AUD_old_SNGC12VIVC,AUD_new_SNGC12VIVC FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC12VIVC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13ARR',AUD_old_SNGC13ARR,AUD_new_SNGC13ARR FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13ARR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13ATEL',AUD_old_SNGC13ATEL,AUD_new_SNGC13ATEL FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDM
stTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13ATEL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13CNEG',AUD_old_SNGC13CNEG,AUD_new_SNGC13CNEG FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13CNEG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13COL',AUD_old_SNGC13COL,AUD_new_SNGC13COL FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13COL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13CORR',AUD_old_SNGC13CORR,AUD_new_SNGC13CORR FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13CORR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DEST',AUD_old_SNGC13DEST,AUD_new_SNGC13DEST FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DEST'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DIR',AUD_old_SNGC13DIR,AUD_new_SNGC13DIR FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DIR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DIST',AUD_old_SNGC13DIST,AUD_new_SNGC13DIST FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DIST'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DPTO',AUD_old_SNGC13DPTO,AUD_new_SNGC13DPTO FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DPTO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DSC1',AUD_old_SNGC13DSC1,AUD_new_SNGC13DSC1 FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DSC1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DSC2',AUD_old_SNGC13DSC2,AUD_new_SNGC13DSC2 FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DSC2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DSC3',AUD_old_SNGC13DSC3,AUD_new_SNGC13DSC3 FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DSC3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DSC4',AUD_old_SNGC13DSC4,AUD_new_SNGC13DSC4 FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DSC4'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DSC5',AUD_old_SNGC13DSC5,AUD_new_SNGC13DSC5 FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DSC5'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13DSC6',AUD_old_SNGC13DSC6,AUD_new_SNGC13DSC6 FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13DSC6'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC1
3_GuidKey,'SNGC13EST',AUD_old_SNGC13EST,AUD_new_SNGC13EST FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13EST'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13FDIR',TO_CHAR(AUD_old_SNGC13FDIR,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNGC13FDIR,'YYYY-MM-DD') FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13FDIR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13FHAB',TO_CHAR(AUD_old_SNGC13FHAB,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNGC13FHAB,'YYYY-MM-DD') FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13FHAB'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13NDOC',AUD_old_SNGC13NDOC,AUD_new_SNGC13NDOC FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13NDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13PAIS',AUD_old_SNGC13PAIS,AUD_new_SNGC13PAIS FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13PAIS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13PDOC',AUD_old_SNGC13PDOC,AUD_new_SNGC13PDOC FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13PDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13PROV',AUD_old_SNGC13PROV,AUD_new_SNGC13PROV FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13PROV'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13RDES',TO_CHAR(AUD_old_SNGC13RDES,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNGC13RDES,'YYYY-MM-DD') FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13RDES'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13REF',AUD_old_SNGC13REF,AUD_new_SNGC13REF FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13REF'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13REF1',AUD_old_SNGC13REF1,AUD_new_SNGC13REF1 FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13REF1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13TAS',AUD_old_SNGC13TAS,AUD_new_SNGC13TAS FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13TAS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13TDOC',AUD_old_SNGC13TDOC,AUD_new_SNGC13TDOC FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13TDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13UGEO',AUD_old_SNGC13UGEO,AUD_new_SNGC13UGEO FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13UGEO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGC13_UOn,AUD_SNGC13_GuidKey,'SNGC13US
ER',AUD_old_SNGC13USER,AUD_new_SNGC13USER FROM BANTPROD.AUD_SNGC13_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey AND AUDMstFld = 'SNGC13USER'); DELETE FROM AUD_SNGC13_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGC13_UOn AND AUDMstId = AUD_SNGC13_GuidKey);  COMMIT ;END IF;END;
/

