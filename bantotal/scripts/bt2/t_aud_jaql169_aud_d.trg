CREATE OR REPLACE TRIGGER T_AUD_JAQL169_AUD_D  AFTER DELETE ON JAQL169  FOR EACH ROW    DECLARE	     RequestNumber VARCHAR2(50);      UserName VARCHAR2(50); 	  WrkstName VARCHAR2(50); 	  Server VARCHAR2(50); 	  Application VARCHAR2(50); 	  ProgramName VARCHAR2(50); 	  TransactionNumber VARCHAR2(50); 	  ConnectionId VARCHAR2(50);      ExistConData NUMBER;    BEGIN      SELECT sys_context('USERENV', 'SID') INTO ConnectionId FROM dual;      SELECT COUNT(*) INTO ExistConData FROM DBA_OBJECTS WHERE OWNER=sys_context( 'userenv', 'current_schema' ) AND OBJECT_TYPE = 'TABLE' AND OBJECT_NAME = 'CONDATA';      IF ExistConData > 0 THEN 		 SELECT MAX(Value) INTO RequestNumber FROM CONDATA WHERE Data ='REQUESTID'; 		 SELECT MAX(Value) INTO UserName FROM CONDATA WHERE Data ='USERID'; 		 SELECT MAX(Value) INTO WrkstName FROM CONDATA WHERE Data ='WRKST'; 		 SELECT MAX(Value) INTO Server FROM CONDATA WHERE Data ='SERVER'; 		 SELECT MAX(Value) INTO Application FROM CONDATA WHERE Data ='APPLICATION'; 		 SELECT MAX(Value) INTO ProgramName FROM CONDATA WHERE Data ='PROGRAM';      END IF;     RequestNumber := COALESCE(RequestNumber,'-1');     TransactionNumber := COALESCE(TransactionNumber,'-1');     ConnectionId := COALESCE(ConnectionId,'-1');     SELECT COALESCE(UserName,sys_context('USERENV', 'SESSION_USER'),'NOTDEFINED') INTO UserName FROM dual;     SELECT COALESCE(WrkstName,sys_context('USERENV', 'HOST'),'NOTDEFINED') INTO WrkstName FROM dual;     SELECT COALESCE(Server,sys_context('USERENV', 'SERVER_HOST'),'NOTDEFINED') INTO Server FROM dual;     SELECT COALESCE(Application,sys_context('USERENV', 'ACTION'),'NOTDEFINED') INTO Application FROM dual;     SELECT COALESCE(ProgramName,sys_context('USERENV', 'ACTION'),'NOTDEFINED') INTO ProgramName FROM dual;      INSERT INTO BANTPROD.AUD_JAQL169_AUDIT (AUD_old_JAQL169ALC,AUD_old_JAQL169CCO,AUD_old_JAQL169CNT,AUD_old_JAQL169COL,AUD_old_JAQL169CTA,AUD_old_JAQL169DES,AUD_old_JAQL169EMB,AUD_old_JAQL169EMP,AUD_old_JAQL169EST,AUD_old_JAQL169FEC,AUD_old_JAQL169FIN,AUD_old_JAQL169FPO,AUD_old_JAQL169FUP,AUD_old_JAQL169GRA,AUD_old_JAQL169HOR,AUD_old_JAQL169IMP,AUD_old_JAQL169INI,AUD_old_JAQL169INS,AUD_old_JAQL169ITM,AUD_old_JAQL169ITR,AUD_old_JAQL169ITS,AUD_old_JAQL169ITT,AUD_old_JAQL169MAD,AUD_old_JAQL169MDA,AUD_old_JAQL169MOA,AUD_old_JAQL169MOD,AUD_old_JAQL169MOT,AUD_old_JAQL169MTO,AUD_old_JAQL169NPR,AUD_old_JAQL169OPE,AUD_old_JAQL169ORI,AUD_old_JAQL169PAP,AUD_old_JAQL169POS,AUD_old_JAQL169PRA,AUD_old_JAQL169PRO,AUD_old_JAQL169PRP,AUD_old_JAQL169RUB,AUD_old_JAQL169SOP,AUD_old_JAQL169SUC,AUD_old_JAQL169TIP,AUD_old_JAQL169TOA,AUD_old_JAQL169TOP,AUD_old_JAQL169USR,AUD_old_JAQL169VAL,AUD_old_JAQL170SBS, AUD_JAQL169_GuidKey ,AUD_JAQL169_UOn,AUD_JAQL169_UT ,AUD_JAQL169_UBR ,AUD_JAQL169_UBC ,AUD_JAQL169_UBT ,AUD_JAQL169_UBU ,AUD_JAQL169_UBA ,AUD_JAQL169_UBS ,AUD_JAQL169_UBP ,AUD_JAQL169_UBM ,AUD_JAQL169_UAs )      VALUES (:old.JAQL169ALC,:old.JAQL169CCO,:old.JAQL169CNT,:old.JAQL169COL,:old.JAQL169CTA,:old.JAQL169DES,:old.JAQL169EMB,:old.JAQL169EMP,:old.JAQL169EST,:old.JAQL169FEC,:old.JAQL169FIN,:old.JAQL169FPO,:old.JAQL169FUP,:old.JAQL169GRA,:old.JAQL169HOR,:old.JAQL169IMP,:old.JAQL169INI,:old.JAQL169INS,:old.JAQL169ITM,:old.JAQL169ITR,:old.JAQL169ITS,:old.JAQL169ITT,:old.JAQL169MAD,:old.JAQL169MDA,:old.JAQL169MOA,:old.JAQL169MOD,:old.JAQL169MOT,:old.JAQL169MTO,:old.JAQL169NPR,:old.JAQL169OPE,:old.JAQL169ORI,:old.JAQL169PAP,:old.JAQL169POS,:old.JAQL169PRA,:old.JAQL169PRO,:old.JAQL169PRP,:old.JAQL169RUB,:old.JAQL169SOP,:old.JAQL169SUC,:old.JAQL169TIP,:old.JAQL169TOA,:old.JAQL169TOP,:old.JAQL169USR,:old.JAQL169VAL,:old.JAQL170SBS, SYS_GUID(),SYSTIMESTAMP,SYSTIMESTAMP,RequestNumber,ConnectionId,TransactionNumber,UserName,Application,Server,ProgramName,WrkstName,'D' ); END T_AUD_JAQL169_AUD_D;
/

