CREATE OR REPLACE PROCEDURE AUD_C_FPP026_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FPP026_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'FPP026',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PP010PRD=', RTRIM(COALESCE(AUD_old_PP010PRD,AUD_new_PP010PRD)) ),CONCAT( '|PP017PAR=', RTRIM(COALESCE(AUD_old_PP017PAR,AUD_new_PP017PAR)) ) ),CONCAT( '|PP026COD=', RTRIM(COALESCE(AUD_old_PP026COD,AUD_new_PP026COD)) ) ),CONCAT( '|PP026EMP=', RTRIM(COALESCE(AUD_old_PP026EMP,AUD_new_PP026EMP)) ) ),CONCAT( '|PP026MDA=', RTRIM(COALESCE(AUD_old_PP026MDA,AUD_new_PP026MDA)) ) ),CONCAT( '|PP026MOD=', RTRIM(COALESCE(AUD_old_PP026MOD,AUD_new_PP026MOD)) ) ),CONCAT( '|PP026PAP=', RTRIM(COALESCE(AUD_old_PP026PAP,AUD_new_PP026PAP)) ) ),CONCAT( '|PP026TIPO=', RTRIM(COALESCE(AUD_old_PP026TIPO,AUD_new_PP026TIPO)) ) ),CONCAT( '|PP026TOP=', RTRIM(COALESCE(AUD_old_PP026TOP,AUD_new_PP026TOP)) ) ),'|' ),AUD_FPP026_UBT,AUD_FPP026_UBU,AUD_FPP026_UBM,AUD_FPP026_UBP,AUD_FPP026_UBR,AUD_FPP026_UAs,AUD_FPP026_UBC,AUD_FPP026_UBA,AUD_FPP026_UBS, '', 'BANTOTAL', '', '', '',AUD_FPP026_UT FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP010PRD',AUD_old_PP010PRD,AUD_new_PP010PRD FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP010PRD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP017PAR',AUD_old_PP017PAR,AUD_new_PP017PAR FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP017PAR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026CAR1',AUD_old_PP026CAR1,AUD_new_PP026CAR1 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026CAR1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026CAR2',AUD_old_PP026CAR2,AUD_new_PP026CAR2 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026CAR2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026CAR3',AUD_old_PP026CAR3,AUD_new_PP026CAR3 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026CAR3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026COD',AUD_old_PP026COD,AUD_new_PP026COD FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026DSC',AUD_old_PP026DSC,AUD_new_PP026DSC FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026DSC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026EMP',AUD_old_PP026EMP,AUD_new_PP026EMP FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026EMP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026FEC1',TO_CHAR(AUD_old_PP026FEC1,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP026FEC1,'YYYY-MM-DD
') FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026FEC1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026FEC2',TO_CHAR(AUD_old_PP026FEC2,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP026FEC2,'YYYY-MM-DD') FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026FEC2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026FEC3',TO_CHAR(AUD_old_PP026FEC3,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP026FEC3,'YYYY-MM-DD') FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026FEC3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026IMP1',AUD_old_PP026IMP1,AUD_new_PP026IMP1 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026IMP1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026IMP2',AUD_old_PP026IMP2,AUD_new_PP026IMP2 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026IMP2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026IMP3',AUD_old_PP026IMP3,AUD_new_PP026IMP3 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026IMP3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026MDA',AUD_old_PP026MDA,AUD_new_PP026MDA FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026MOD',AUD_old_PP026MOD,AUD_new_PP026MOD FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026MODI',AUD_old_PP026MODI,AUD_new_PP026MODI FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026MODI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026NUM1',AUD_old_PP026NUM1,AUD_new_PP026NUM1 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026NUM1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026NUM2',AUD_old_PP026NUM2,AUD_new_PP026NUM2 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026NUM2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026NUM3',AUD_old_PP026NUM3,AUD_new_PP026NUM3 FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026NUM3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026ORD',AUD_old_PP026ORD,AUD_new_PP026ORD FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026ORD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026PAP',AUD_old_PP026PAP,AUD_new_PP026PAP FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND
 AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026TIPO',AUD_old_PP026TIPO,AUD_new_PP026TIPO FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026TIPO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP026_UOn,AUD_FPP026_GuidKey,'PP026TOP',AUD_old_PP026TOP,AUD_new_PP026TOP FROM BANTPROD.AUD_FPP026_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey AND AUDMstFld = 'PP026TOP'); DELETE FROM AUD_FPP026_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP026_UOn AND AUDMstId = AUD_FPP026_GuidKey);  COMMIT ;END IF;END;
/

