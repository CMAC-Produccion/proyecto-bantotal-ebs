CREATE OR REPLACE PROCEDURE AUD_C_X054010_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_X054010_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'X054010',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PGCOD=', RTRIM(COALESCE(AUD_old_PGCOD,AUD_new_PGCOD)) ),CONCAT( '|XPREMOD=', RTRIM(COALESCE(AUD_old_XPREMOD,AUD_new_XPREMOD)) ) ),CONCAT( '|XPREMONEDA=', RTRIM(COALESCE(AUD_old_XPREMONEDA,AUD_new_XPREMONEDA)) ) ),CONCAT( '|XPREPAPEL=', RTRIM(COALESCE(AUD_old_XPREPAPEL,AUD_new_XPREPAPEL)) ) ),CONCAT( '|XPRETOPE=', RTRIM(COALESCE(AUD_old_XPRETOPE,AUD_new_XPRETOPE)) ) ),'|' ),AUD_X054010_UBT,AUD_X054010_UBU,AUD_X054010_UBM,AUD_X054010_UBP,AUD_X054010_UBR,AUD_X054010_UAs,AUD_X054010_UBC,AUD_X054010_UBA,AUD_X054010_UBS, '', 'BANTOTAL', '', '', '',AUD_X054010_UT FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'PGCOD',AUD_old_PGCOD,AUD_new_PGCOD FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'PGCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRECAPMAX',AUD_old_XPRECAPMAX,AUD_new_XPRECAPMAX FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRECAPMAX'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRECAPMIN',AUD_old_XPRECAPMIN,AUD_new_XPRECAPMIN FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRECAPMIN'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRECLTCOD',AUD_old_XPRECLTCOD,AUD_new_XPRECLTCOD FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRECLTCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREDESC',AUD_old_XPREDESC,AUD_new_XPREDESC FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREDESC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREDIAMAX',AUD_old_XPREDIAMAX,AUD_new_XPREDIAMAX FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREDIAMAX'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREDIAMIN',AUD_old_XPREDIAMIN,AUD_new_XPREDIAMIN FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREDIAMIN'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREDREV',AUD_old_XPREDREV,AUD_new_XPREDREV FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREDREV'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREGRIMMA',AUD_old_XPREGRIMMA,AUD_new_XPREGRIMMA FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREGRIMMA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREGRIMMI',AUD_old_XPREGRIMMI,AUD_new_XPREGRIMMI FROM B
ANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREGRIMMI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREGRPEMA',AUD_old_XPREGRPEMA,AUD_new_XPREGRPEMA FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREGRPEMA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREGRPEMI',AUD_old_XPREGRPEMI,AUD_new_XPREGRPEMI FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREGRPEMI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREGRPRMA',AUD_old_XPREGRPRMA,AUD_new_XPREGRPRMA FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREGRPRMA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREGRPRMI',AUD_old_XPREGRPRMI,AUD_new_XPREGRPRMI FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREGRPRMI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRELIBRE',AUD_old_XPRELIBRE,AUD_new_XPRELIBRE FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRELIBRE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREMOD',AUD_old_XPREMOD,AUD_new_XPREMOD FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREMOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREMONEDA',AUD_old_XPREMONEDA,AUD_new_XPREMONEDA FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREMONEDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREPAPEL',AUD_old_XPREPAPEL,AUD_new_XPREPAPEL FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREPAPEL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREPERMAX',AUD_old_XPREPERMAX,AUD_new_XPREPERMAX FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREPERMAX'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREPERMIN',AUD_old_XPREPERMIN,AUD_new_XPREPERMIN FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREPERMIN'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREPLUS',AUD_old_XPREPLUS,AUD_new_XPREPLUS FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREPLUS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETAPIZ',AUD_old_XPRETAPIZ,AUD_new_XPRETAPIZ FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETAPIZ'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETASA',AUD_old_XPRETASA,AUD_new_XPRETASA FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND 
AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETASA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETFER',AUD_old_XPRETFER,AUD_new_XPRETFER FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETFER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETIPAMO',AUD_old_XPRETIPAMO,AUD_new_XPRETIPAMO FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETIPAMO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETIPANO',AUD_old_XPRETIPANO,AUD_new_XPRETIPANO FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETIPANO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETIPDIA',AUD_old_XPRETIPDIA,AUD_new_XPRETIPDIA FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETIPDIA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETOPE',AUD_old_XPRETOPE,AUD_new_XPRETOPE FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETOPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPRETTASA',AUD_old_XPRETTASA,AUD_new_XPRETTASA FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPRETTASA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_X054010_UOn,AUD_X054010_GuidKey,'XPREVTOS',AUD_old_XPREVTOS,AUD_new_XPREVTOS FROM BANTPROD.AUD_X054010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey AND AUDMstFld = 'XPREVTOS'); DELETE FROM AUD_X054010_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_X054010_UOn AND AUDMstId = AUD_X054010_GuidKey);  COMMIT ;END IF;END;
/

