CREATE OR REPLACE PROCEDURE AUD_C_FSD602_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FSD602_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'FSD602',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PGCOD=', RTRIM(COALESCE(AUD_old_PGCOD,AUD_new_PGCOD)) ),CONCAT( '|PP1NUMP=', RTRIM(COALESCE(AUD_old_PP1NUMP,AUD_new_PP1NUMP)) ) ),CONCAT( '|PPCTA=', RTRIM(COALESCE(AUD_old_PPCTA,AUD_new_PPCTA)) ) ),CONCAT( '|PPFPAG=', RTRIM(COALESCE(AUD_old_PPFPAG,AUD_new_PPFPAG)) ) ),CONCAT( '|PPMDA=', RTRIM(COALESCE(AUD_old_PPMDA,AUD_new_PPMDA)) ) ),CONCAT( '|PPMOD=', RTRIM(COALESCE(AUD_old_PPMOD,AUD_new_PPMOD)) ) ),CONCAT( '|PPOPER=', RTRIM(COALESCE(AUD_old_PPOPER,AUD_new_PPOPER)) ) ),CONCAT( '|PPPAP=', RTRIM(COALESCE(AUD_old_PPPAP,AUD_new_PPPAP)) ) ),CONCAT( '|PPSBOP=', RTRIM(COALESCE(AUD_old_PPSBOP,AUD_new_PPSBOP)) ) ),CONCAT( '|PPSUC=', RTRIM(COALESCE(AUD_old_PPSUC,AUD_new_PPSUC)) ) ),CONCAT( '|PPTIPO=', RTRIM(COALESCE(AUD_old_PPTIPO,AUD_new_PPTIPO)) ) ),CONCAT( '|PPTOPE=', RTRIM(COALESCE(AUD_old_PPTOPE,AUD_new_PPTOPE)) ) ),'|' ),AUD_FSD602_UBT,AUD_FSD602_UBU,AUD_FSD602_UBM,AUD_FSD602_UBP,AUD_FSD602_UBR,AUD_FSD602_UAs,AUD_FSD602_UBC,AUD_FSD602_UBA,AUD_FSD602_UBS, '', 'BANTOTAL', '', '', '',AUD_FSD602_UT FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602CD',AUD_old_D602CD,AUD_new_D602CD FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602CD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602CO',AUD_old_D602CO,AUD_new_D602CO FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602CO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602FC',TO_CHAR(AUD_old_D602FC,'YYYY-MM-DD'),TO_CHAR(AUD_new_D602FC,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602FC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602MO',AUD_old_D602MO,AUD_new_D602MO FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602MO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602OR',AUD_old_D602OR,AUD_new_D602OR FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602OR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602RE',AUD_old_D602RE,AUD_new_D602RE FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602RE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602SB',AUD_old_D602SB,AUD_new_D602SB FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602SB'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602SU',AUD_old_D602SU,AUD_new_D602SU FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602SU'); INSERT INTO BANTPROD.AUD0
05 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'D602TR',AUD_old_D602TR,AUD_new_D602TR FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'D602TR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PGCOD',AUD_old_PGCOD,AUD_new_PGCOD FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PGCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1CAP',AUD_old_PP1CAP,AUD_new_PP1CAP FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1CAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1FECH',TO_CHAR(AUD_old_PP1FECH,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP1FECH,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1FECH'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1ICAP',AUD_old_PP1ICAP,AUD_new_PP1ICAP FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1ICAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1IINT',AUD_old_PP1IINT,AUD_new_PP1IINT FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1IINT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1IINTM',AUD_old_PP1IINTM,AUD_new_PP1IINTM FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1IINTM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1INT',AUD_old_PP1INT,AUD_new_PP1INT FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1INT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1INTM',AUD_old_PP1INTM,AUD_new_PP1INTM FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1INTM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1INTMEX',AUD_old_PP1INTMEX,AUD_new_PP1INTMEX FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1INTMEX'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1INTMMEX',AUD_old_PP1INTMMEX,AUD_new_PP1INTMMEX FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1INTMMEX'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1NUMP',AUD_old_PP1NUMP,AUD_new_PP1NUMP FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1NUMP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1SALADE',AUD_old_PP1SALADE,AUD_new_PP1SALADE FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1SALADE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1SALADEM',AUD_old_PP1SALADEM,AUD_new_PP1SALADEM FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKe
y AND AUDMstFld = 'PP1SALADEM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1SALCAP',AUD_old_PP1SALCAP,AUD_new_PP1SALCAP FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1SALCAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1SALINT',AUD_old_PP1SALINT,AUD_new_PP1SALINT FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1SALINT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1SALINTM',AUD_old_PP1SALINTM,AUD_new_PP1SALINTM FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1SALINTM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1SALMOR',AUD_old_PP1SALMOR,AUD_new_PP1SALMOR FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1SALMOR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1SALMORM',AUD_old_PP1SALMORM,AUD_new_PP1SALMORM FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1SALMORM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PP1STAT',AUD_old_PP1STAT,AUD_new_PP1STAT FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PP1STAT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPCTA',AUD_old_PPCTA,AUD_new_PPCTA FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPCTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPFPAG',TO_CHAR(AUD_old_PPFPAG,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPFPAG,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPFPAG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPMDA',AUD_old_PPMDA,AUD_new_PPMDA FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPMDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPMOD',AUD_old_PPMOD,AUD_new_PPMOD FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPMOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPOPER',AUD_old_PPOPER,AUD_new_PPOPER FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPOPER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPPAP',AUD_old_PPPAP,AUD_new_PPPAP FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPPAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPSBOP',AUD_old_PPSBOP,AUD_new_PPSBOP FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPSBOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPSUC',AUD_old_PPSUC,AUD_new_PPSUC FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_U
On AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPSUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPTIPO',AUD_old_PPTIPO,AUD_new_PPTIPO FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPTIPO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD602_UOn,AUD_FSD602_GuidKey,'PPTOPE',AUD_old_PPTOPE,AUD_new_PPTOPE FROM BANTPROD.AUD_FSD602_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey AND AUDMstFld = 'PPTOPE'); DELETE FROM AUD_FSD602_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD602_UOn AND AUDMstId = AUD_FSD602_GuidKey);  COMMIT ;END IF;END;
/

