CREATE OR REPLACE PROCEDURE AUD_C_FSD601_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FSD601_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'FSD601',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PGCOD=', RTRIM(COALESCE(AUD_old_PGCOD,AUD_new_PGCOD)) ),CONCAT( '|PPCTA=', RTRIM(COALESCE(AUD_old_PPCTA,AUD_new_PPCTA)) ) ),CONCAT( '|PPFPAG=', RTRIM(COALESCE(AUD_old_PPFPAG,AUD_new_PPFPAG)) ) ),CONCAT( '|PPMDA=', RTRIM(COALESCE(AUD_old_PPMDA,AUD_new_PPMDA)) ) ),CONCAT( '|PPMOD=', RTRIM(COALESCE(AUD_old_PPMOD,AUD_new_PPMOD)) ) ),CONCAT( '|PPOPER=', RTRIM(COALESCE(AUD_old_PPOPER,AUD_new_PPOPER)) ) ),CONCAT( '|PPPAP=', RTRIM(COALESCE(AUD_old_PPPAP,AUD_new_PPPAP)) ) ),CONCAT( '|PPSBOP=', RTRIM(COALESCE(AUD_old_PPSBOP,AUD_new_PPSBOP)) ) ),CONCAT( '|PPSUC=', RTRIM(COALESCE(AUD_old_PPSUC,AUD_new_PPSUC)) ) ),CONCAT( '|PPTIPO=', RTRIM(COALESCE(AUD_old_PPTIPO,AUD_new_PPTIPO)) ) ),CONCAT( '|PPTOPE=', RTRIM(COALESCE(AUD_old_PPTOPE,AUD_new_PPTOPE)) ) ),'|' ),AUD_FSD601_UBT,AUD_FSD601_UBU,AUD_FSD601_UBM,AUD_FSD601_UBP,AUD_FSD601_UBR,AUD_FSD601_UAs,AUD_FSD601_UBC,AUD_FSD601_UBA,AUD_FSD601_UBS, '', 'BANTOTAL', '', '', '',AUD_FSD601_UT FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601CD',AUD_old_D601CD,AUD_new_D601CD FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601CD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601CO',AUD_old_D601CO,AUD_new_D601CO FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601CO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601FC',TO_CHAR(AUD_old_D601FC,'YYYY-MM-DD'),TO_CHAR(AUD_new_D601FC,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601FC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601MO',AUD_old_D601MO,AUD_new_D601MO FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601MO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601OR',AUD_old_D601OR,AUD_new_D601OR FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601OR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601RE',AUD_old_D601RE,AUD_new_D601RE FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601RE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601SB',AUD_old_D601SB,AUD_new_D601SB FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601SB'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601SU',AUD_old_D601SU,AUD_new_D601SU FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601SU'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'D601TR',AUD_old_D601TR,AUD_new_D601TR
 FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'D601TR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PGCOD',AUD_old_PGCOD,AUD_new_PGCOD FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PGCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPCAP',AUD_old_PPCAP,AUD_new_PPCAP FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPCAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPCTA',AUD_old_PPCTA,AUD_new_PPCTA FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPCTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPFINV',AUD_old_PPFINV,AUD_new_PPFINV FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPFINV'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPFPAG',TO_CHAR(AUD_old_PPFPAG,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPFPAG,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPFPAG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPFVAL',TO_CHAR(AUD_old_PPFVAL,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPFVAL,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPFVAL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPFVTO',TO_CHAR(AUD_old_PPFVTO,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPFVTO,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPFVTO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPICAP',AUD_old_PPICAP,AUD_new_PPICAP FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPICAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPIINT',AUD_old_PPIINT,AUD_new_PPIINT FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPIINT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPINT',AUD_old_PPINT,AUD_new_PPINT FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPINT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPINTMEX',AUD_old_PPINTMEX,AUD_new_PPINTMEX FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPINTMEX'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPMDA',AUD_old_PPMDA,AUD_new_PPMDA FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPMDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPMOD',AUD_old_PPMOD,AUD_new_PPMOD FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPMOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD
601_GuidKey,'PPNUME',AUD_old_PPNUME,AUD_new_PPNUME FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPNUME'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPOPER',AUD_old_PPOPER,AUD_new_PPOPER FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPOPER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPPAP',AUD_old_PPPAP,AUD_new_PPPAP FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPPAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPPZO',AUD_old_PPPZO,AUD_new_PPPZO FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPPZO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPSBOP',AUD_old_PPSBOP,AUD_new_PPSBOP FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPSBOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPSTAT',AUD_old_PPSTAT,AUD_new_PPSTAT FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPSTAT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPSUC',AUD_old_PPSUC,AUD_new_PPSUC FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPSUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPTIPO',AUD_old_PPTIPO,AUD_new_PPTIPO FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPTIPO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD601_UOn,AUD_FSD601_GuidKey,'PPTOPE',AUD_old_PPTOPE,AUD_new_PPTOPE FROM BANTPROD.AUD_FSD601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey AND AUDMstFld = 'PPTOPE'); DELETE FROM AUD_FSD601_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD601_UOn AND AUDMstId = AUD_FSD601_GuidKey);  COMMIT ;END IF;END;
/

