CREATE OR REPLACE TRIGGER T_AUD_TI0019_AUD_D  AFTER DELETE ON TI0019  FOR EACH ROW    DECLARE	     RequestNumber VARCHAR2(50);      UserName VARCHAR2(50); 	  WrkstName VARCHAR2(50); 	  Server VARCHAR2(50); 	  Application VARCHAR2(50); 	  ProgramName VARCHAR2(50); 	  TransactionNumber VARCHAR2(50); 	  ConnectionId VARCHAR2(50);      ExistConData NUMBER;    BEGIN      SELECT sys_context('USERENV', 'SID') INTO ConnectionId FROM dual;      SELECT COUNT(*) INTO ExistConData FROM DBA_OBJECTS WHERE OWNER=sys_context( 'userenv', 'current_schema' ) AND OBJECT_TYPE = 'TABLE' AND OBJECT_NAME = 'CONDATA';      IF ExistConData > 0 THEN 		 SELECT MAX(Value) INTO RequestNumber FROM CONDATA WHERE Data ='REQUESTID'; 		 SELECT MAX(Value) INTO UserName FROM CONDATA WHERE Data ='USERID'; 		 SELECT MAX(Value) INTO WrkstName FROM CONDATA WHERE Data ='WRKST'; 		 SELECT MAX(Value) INTO Server FROM CONDATA WHERE Data ='SERVER'; 		 SELECT MAX(Value) INTO Application FROM CONDATA WHERE Data ='APPLICATION'; 		 SELECT MAX(Value) INTO ProgramName FROM CONDATA WHERE Data ='PROGRAM';      END IF;     RequestNumber := COALESCE(RequestNumber,'-1');     TransactionNumber := COALESCE(TransactionNumber,'-1');     ConnectionId := COALESCE(ConnectionId,'-1');     SELECT COALESCE(UserName,sys_context('USERENV', 'SESSION_USER'),'NOTDEFINED') INTO UserName FROM dual;     SELECT COALESCE(WrkstName,sys_context('USERENV', 'HOST'),'NOTDEFINED') INTO WrkstName FROM dual;     SELECT COALESCE(Server,sys_context('USERENV', 'SERVER_HOST'),'NOTDEFINED') INTO Server FROM dual;     SELECT COALESCE(Application,sys_context('USERENV', 'ACTION'),'NOTDEFINED') INTO Application FROM dual;     SELECT COALESCE(ProgramName,sys_context('USERENV', 'ACTION'),'NOTDEFINED') INTO ProgramName FROM dual;      INSERT INTO BANTPROD.AUD_TI0019_AUDIT (AUD_old_TICODHISTO,AUD_old_TICODMOV,AUD_old_TICONTABIL,AUD_old_TICORRELAI,AUD_old_TICORRT,AUD_old_TIDBHA,AUD_old_TIFCHC,AUD_old_TIFORDI,AUD_old_TIFVAL,AUD_old_TIHSCCTA,AUD_old_TIHSCMDA,AUD_old_TIHSCMOD,AUD_old_TIHSCOPER,AUD_old_TIHSCPAP,AUD_old_TIHSCSBOP,AUD_old_TIHSCSUC,AUD_old_TIHSCTOPE,AUD_old_TIIMPORTET,AUD_old_TIMDA,AUD_old_TIMODT,AUD_old_TIMONTOIMP,AUD_old_TINREL,AUD_old_TIORDD,AUD_old_TIORDO,AUD_old_TIPGCOD,AUD_old_TIPSUC,AUD_old_TISBORDEST,AUD_old_TISBORORIG,AUD_old_TITRN, AUD_TI0019_GuidKey ,AUD_TI0019_UOn,AUD_TI0019_UT ,AUD_TI0019_UBR ,AUD_TI0019_UBC ,AUD_TI0019_UBT ,AUD_TI0019_UBU ,AUD_TI0019_UBA ,AUD_TI0019_UBS ,AUD_TI0019_UBP ,AUD_TI0019_UBM ,AUD_TI0019_UAs )      VALUES (:old.TICODHISTO,:old.TICODMOV,:old.TICONTABIL,:old.TICORRELAI,:old.TICORRT,:old.TIDBHA,:old.TIFCHC,:old.TIFORDI,:old.TIFVAL,:old.TIHSCCTA,:old.TIHSCMDA,:old.TIHSCMOD,:old.TIHSCOPER,:old.TIHSCPAP,:old.TIHSCSBOP,:old.TIHSCSUC,:old.TIHSCTOPE,:old.TIIMPORTET,:old.TIMDA,:old.TIMODT,:old.TIMONTOIMP,:old.TINREL,:old.TIORDD,:old.TIORDO,:old.TIPGCOD,:old.TIPSUC,:old.TISBORDEST,:old.TISBORORIG,:old.TITRN, SYS_GUID(),SYSTIMESTAMP,SYSTIMESTAMP,RequestNumber,ConnectionId,TransactionNumber,UserName,Application,Server,ProgramName,WrkstName,'D' ); END T_AUD_TI0019_AUD_D;
/

