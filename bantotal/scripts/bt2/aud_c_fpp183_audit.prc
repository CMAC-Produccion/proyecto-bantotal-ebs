CREATE OR REPLACE PROCEDURE AUD_C_FPP183_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FPP183_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'FPP183',CONCAT( CONCAT( CONCAT( CONCAT( '|PP173COD=', RTRIM(COALESCE(AUD_old_PP173COD,AUD_new_PP173COD)) ),CONCAT( '|PP174COD=', RTRIM(COALESCE(AUD_old_PP174COD,AUD_new_PP174COD)) ) ),CONCAT( '|PP183COD=', RTRIM(COALESCE(AUD_old_PP183COD,AUD_new_PP183COD)) ) ),'|' ),AUD_FPP183_UBT,AUD_FPP183_UBU,AUD_FPP183_UBM,AUD_FPP183_UBP,AUD_FPP183_UBR,AUD_FPP183_UAs,AUD_FPP183_UBC,AUD_FPP183_UBA,AUD_FPP183_UBS, '', 'BANTOTAL', '', '', '',AUD_FPP183_UT FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP173COD',AUD_old_PP173COD,AUD_new_PP173COD FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP173COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP174COD',AUD_old_PP174COD,AUD_new_PP174COD FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP174COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP182COD',AUD_old_PP182COD,AUD_new_PP182COD FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP182COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX1',AUD_old_PP183AUX1,AUD_new_PP183AUX1 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX10',AUD_old_PP183AUX10,AUD_new_PP183AUX10 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX10'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX11',AUD_old_PP183AUX11,AUD_new_PP183AUX11 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX11'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX12',AUD_old_PP183AUX12,AUD_new_PP183AUX12 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX12'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX2',AUD_old_PP183AUX2,AUD_new_PP183AUX2 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX3',AUD_old_PP183AUX3,AUD_new_PP183AUX3 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX4',AUD_old_PP183AUX4,AUD_new_PP183AUX4 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX4'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_Guid
Key,'PP183AUX5',AUD_old_PP183AUX5,AUD_new_PP183AUX5 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX5'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX6',AUD_old_PP183AUX6,AUD_new_PP183AUX6 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX6'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX7',AUD_old_PP183AUX7,AUD_new_PP183AUX7 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX7'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX8',AUD_old_PP183AUX8,AUD_new_PP183AUX8 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX8'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183AUX9',AUD_old_PP183AUX9,AUD_new_PP183AUX9 FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183AUX9'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183COD',AUD_old_PP183COD,AUD_new_PP183COD FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183CON',AUD_old_PP183CON,AUD_new_PP183CON FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183CON'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183FCON',TO_CHAR(AUD_old_PP183FCON,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP183FCON,'YYYY-MM-DD') FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183FCON'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183FEC',TO_CHAR(AUD_old_PP183FEC,'YYYY-MM-DD'),TO_CHAR(AUD_new_PP183FEC,'YYYY-MM-DD') FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183FEC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183MOD',AUD_old_PP183MOD,AUD_new_PP183MOD FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183NREL',AUD_old_PP183NREL,AUD_new_PP183NREL FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183NREL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183ORD',AUD_old_PP183ORD,AUD_new_PP183ORD FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183ORD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183PGCOD',AUD_old_PP183PGCOD,AUD_new_PP183PGCOD FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183PGCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183SBO',AUD_old_PP183SBO,AUD_new_PP183SBO FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPRO
D.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183SBO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183SUC',AUD_old_PP183SUC,AUD_new_PP183SUC FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183SUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP183_UOn,AUD_FPP183_GuidKey,'PP183TRAN',AUD_old_PP183TRAN,AUD_new_PP183TRAN FROM BANTPROD.AUD_FPP183_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey AND AUDMstFld = 'PP183TRAN'); DELETE FROM AUD_FPP183_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP183_UOn AND AUDMstId = AUD_FPP183_GuidKey);  COMMIT ;END IF;END;
/

