CREATE OR REPLACE PROCEDURE AUD_C_PPG000_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_PPG000_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PPG000COR=', RTRIM(COALESCE(AUD_old_PPG000COR,AUD_new_PPG000COR)) ),CONCAT( '|PPG000CTA=', RTRIM(COALESCE(AUD_old_PPG000CTA,AUD_new_PPG000CTA)) ) ),CONCAT( '|PPG000FRM=', RTRIM(COALESCE(AUD_old_PPG000FRM,AUD_new_PPG000FRM)) ) ),CONCAT( '|PPG000MDA=', RTRIM(COALESCE(AUD_old_PPG000MDA,AUD_new_PPG000MDA)) ) ),CONCAT( '|PPG000MOD=', RTRIM(COALESCE(AUD_old_PPG000MOD,AUD_new_PPG000MOD)) ) ),CONCAT( '|PPG000OPE=', RTRIM(COALESCE(AUD_old_PPG000OPE,AUD_new_PPG000OPE)) ) ),CONCAT( '|PPG000PAP=', RTRIM(COALESCE(AUD_old_PPG000PAP,AUD_new_PPG000PAP)) ) ),CONCAT( '|PPG000PGC=', RTRIM(COALESCE(AUD_old_PPG000PGC,AUD_new_PPG000PGC)) ) ),CONCAT( '|PPG000SBO=', RTRIM(COALESCE(AUD_old_PPG000SBO,AUD_new_PPG000SBO)) ) ),CONCAT( '|PPG000SUC=', RTRIM(COALESCE(AUD_old_PPG000SUC,AUD_new_PPG000SUC)) ) ),CONCAT( '|PPG000TOP=', RTRIM(COALESCE(AUD_old_PPG000TOP,AUD_new_PPG000TOP)) ) ),'|' ),AUD_PPG000_UBT,AUD_PPG000_UBU,AUD_PPG000_UBM,AUD_PPG000_UBP,AUD_PPG000_UBR,AUD_PPG000_UAs,AUD_PPG000_UBC,AUD_PPG000_UBA,AUD_PPG000_UBS, '', 'BANTOTAL', '', '', '',AUD_PPG000_UT FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000AU1',AUD_old_PPG000AU1,AUD_new_PPG000AU1 FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000AU1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000AU2',AUD_old_PPG000AU2,AUD_new_PPG000AU2 FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000AU2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000AU3',AUD_old_PPG000AU3,AUD_new_PPG000AU3 FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000AU3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000AU4',TO_CHAR(AUD_old_PPG000AU4,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPG000AU4,'YYYY-MM-DD') FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000AU4'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000AU5',TO_CHAR(AUD_old_PPG000AU5,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPG000AU5,'YYYY-MM-DD') FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000AU5'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000AU6',AUD_old_PPG000AU6,AUD_new_PPG000AU6 FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000AU6'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000AU7',AUD_old_PPG000AU7,AUD_new_PPG000AU7 FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000AU7'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000COR',AUD_old_PPG000COR,AUD_new_PPG000COR FROM BANTPROD.AUD_PPG000_A
UDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000COR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000CTA',AUD_old_PPG000CTA,AUD_new_PPG000CTA FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000CTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000FRM',AUD_old_PPG000FRM,AUD_new_PPG000FRM FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000FRM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000MDA',AUD_old_PPG000MDA,AUD_new_PPG000MDA FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000MOD',AUD_old_PPG000MOD,AUD_new_PPG000MOD FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000OPE',AUD_old_PPG000OPE,AUD_new_PPG000OPE FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000OPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000PAP',AUD_old_PPG000PAP,AUD_new_PPG000PAP FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000PGC',AUD_old_PPG000PGC,AUD_new_PPG000PGC FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000PGC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000SBO',AUD_old_PPG000SBO,AUD_new_PPG000SBO FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000SBO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000SUC',AUD_old_PPG000SUC,AUD_new_PPG000SUC FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000SUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TCO',AUD_old_PPG000TCO,AUD_new_PPG000TCO FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TCO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TFC',TO_CHAR(AUD_old_PPG000TFC,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPG000TFC,'YYYY-MM-DD') FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TFC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TMD',AUD_old_PPG000TMD,AUD_new_PPG000TMD FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TMD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TNR',AUD_old_PPG000TNR,AUD_new_PPG000TNR FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TNR'
); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TOP',AUD_old_PPG000TOP,AUD_new_PPG000TOP FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TOR',AUD_old_PPG000TOR,AUD_new_PPG000TOR FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TOR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TPG',AUD_old_PPG000TPG,AUD_new_PPG000TPG FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TPG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TSC',AUD_old_PPG000TSC,AUD_new_PPG000TSC FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TSC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TSO',AUD_old_PPG000TSO,AUD_new_PPG000TSO FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TSO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_PPG000_UOn,AUD_PPG000_GuidKey,'PPG000TTR',AUD_old_PPG000TTR,AUD_new_PPG000TTR FROM BANTPROD.AUD_PPG000_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey AND AUDMstFld = 'PPG000TTR'); DELETE FROM AUD_PPG000_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_PPG000_UOn AND AUDMstId = AUD_PPG000_GuidKey);  COMMIT ;END IF;END;
/

