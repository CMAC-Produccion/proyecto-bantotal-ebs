CREATE OR REPLACE PROCEDURE AUD_C_FPP109_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FPP109_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'FPP109',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PP109CORR=', RTRIM(COALESCE(AUD_old_PP109CORR,AUD_new_PP109CORR)) ),CONCAT( '|PP109FACT=', RTRIM(COALESCE(AUD_old_PP109FACT,AUD_new_PP109FACT)) ) ),CONCAT( '|PP109NCART=', RTRIM(COALESCE(AUD_old_PP109NCART,AUD_new_PP109NCART)) ) ),CONCAT( '|PP109TACT=', RTRIM(COALESCE(AUD_old_PP109TACT,AUD_new_PP109TACT)) ) ),'|' ),AUD_FPP109_UBT,AUD_FPP109_UBU,AUD_FPP109_UBM,AUD_FPP109_UBP,AUD_FPP109_UBR,AUD_FPP109_UAs,AUD_FPP109_UBC,AUD_FPP109_UBA,AUD_FPP109_UBS, '', 'BANTOTAL', '', '', '',AUD_FPP109_UT FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX1',AUD_old_PP109AUX1,AUD_new_PP109AUX1 FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX2',AUD_old_PP109AUX2,AUD_new_PP109AUX2 FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX3',AUD_old_PP109AUX3,AUD_new_PP109AUX3 FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX4',AUD_old_PP109AUX4,AUD_new_PP109AUX4 FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX4'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX5',TO_CHAR(AUD_old_PP109AUX5,'YYYY-MM-DD HH24:MI:SS.FF'),TO_CHAR(AUD_new_PP109AUX5,'YYYY-MM-DD HH24:MI:SS.FF') FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX5'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX6',TO_CHAR(AUD_old_PP109AUX6,'YYYY-MM-DD HH24:MI:SS.FF'),TO_CHAR(AUD_new_PP109AUX6,'YYYY-MM-DD HH24:MI:SS.FF') FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX6'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX7',AUD_old_PP109AUX7,AUD_new_PP109AUX7 FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX7'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX8',AUD_old_PP109AUX8,AUD_new_PP109AUX8 FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX8'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109AUX9',AUD_old_PP109AUX9,AUD_new_PP109AUX9 FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109AUX9'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109CODE',AUD_old_PP109CODE,AUD_new_PP109CO
DE FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109CODE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109CORR',AUD_old_PP109CORR,AUD_new_PP109CORR FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109CORR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109CTA',AUD_old_PP109CTA,AUD_new_PP109CTA FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109CTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109DESE',AUD_old_PP109DESE,AUD_new_PP109DESE FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109DESE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109FACT',TO_CHAR(AUD_old_PP109FACT,'YYYY-MM-DD HH24:MI:SS.FF'),TO_CHAR(AUD_new_PP109FACT,'YYYY-MM-DD HH24:MI:SS.FF') FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109FACT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109MDA',AUD_old_PP109MDA,AUD_new_PP109MDA FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109MOD',AUD_old_PP109MOD,AUD_new_PP109MOD FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109NCART',AUD_old_PP109NCART,AUD_new_PP109NCART FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109NCART'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109OPE',AUD_old_PP109OPE,AUD_new_PP109OPE FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109OPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109PAP',AUD_old_PP109PAP,AUD_new_PP109PAP FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109PGC',AUD_old_PP109PGC,AUD_new_PP109PGC FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109PGC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109SBO',AUD_old_PP109SBO,AUD_new_PP109SBO FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109SBO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109SUC',AUD_old_PP109SUC,AUD_new_PP109SUC FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109SUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109TACT',AUD_old_PP109TACT,AUD_new_PP109TACT FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKe
y AND AUDMstFld = 'PP109TACT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FPP109_UOn,AUD_FPP109_GuidKey,'PP109TOP',AUD_old_PP109TOP,AUD_new_PP109TOP FROM BANTPROD.AUD_FPP109_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey AND AUDMstFld = 'PP109TOP'); DELETE FROM AUD_FPP109_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FPP109_UOn AND AUDMstId = AUD_FPP109_GuidKey);  COMMIT ;END IF;END;
/

