CREATE OR REPLACE TRIGGER T_AUD_FSD001_AUD_U  AFTER UPDATE ON FSD001  FOR EACH ROW    DECLARE	     RequestNumber VARCHAR2(50);      UserName VARCHAR2(50); 	  WrkstName VARCHAR2(50); 	  Server VARCHAR2(50); 	  Application VARCHAR2(50); 	  ProgramName VARCHAR2(50); 	  TransactionNumber VARCHAR2(50); 	  ConnectionId VARCHAR2(50);      ExistConData NUMBER;    BEGIN      SELECT sys_context('USERENV', 'SID') INTO ConnectionId FROM dual;      SELECT COUNT(*) INTO ExistConData FROM DBA_OBJECTS WHERE OWNER=sys_context( 'userenv', 'current_schema' ) AND OBJECT_TYPE = 'TABLE' AND OBJECT_NAME = 'CONDATA';      IF ExistConData > 0 THEN 		 SELECT MAX(Value) INTO RequestNumber FROM CONDATA WHERE Data ='REQUESTID'; 		 SELECT MAX(Value) INTO UserName FROM CONDATA WHERE Data ='USERID'; 		 SELECT MAX(Value) INTO WrkstName FROM CONDATA WHERE Data ='WRKST'; 		 SELECT MAX(Value) INTO Server FROM CONDATA WHERE Data ='SERVER'; 		 SELECT MAX(Value) INTO Application FROM CONDATA WHERE Data ='APPLICATION'; 		 SELECT MAX(Value) INTO ProgramName FROM CONDATA WHERE Data ='PROGRAM';      END IF;     RequestNumber := COALESCE(RequestNumber,'-1');     TransactionNumber := COALESCE(TransactionNumber,'-1');     ConnectionId := COALESCE(ConnectionId,'-1');     SELECT COALESCE(UserName,sys_context('USERENV', 'SESSION_USER'),'NOTDEFINED') INTO UserName FROM dual;     SELECT COALESCE(WrkstName,sys_context('USERENV', 'HOST'),'NOTDEFINED') INTO WrkstName FROM dual;     SELECT COALESCE(Server,sys_context('USERENV', 'SERVER_HOST'),'NOTDEFINED') INTO Server FROM dual;     SELECT COALESCE(Application,sys_context('USERENV', 'ACTION'),'NOTDEFINED') INTO Application FROM dual;     SELECT COALESCE(ProgramName,sys_context('USERENV', 'ACTION'),'NOTDEFINED') INTO ProgramName FROM dual;     INSERT INTO BANTPROD.AUD_FSD001_AUDIT (AUD_new_PEBCEAJINF,AUD_new_PEBPS,AUD_new_PECONSFIN,AUD_new_PEDGI,AUD_new_PEEMB,AUD_new_PEEXENTO,AUD_new_PEFALT,AUD_new_PEFBAJ,AUD_new_PEFEMB,AUD_new_PEFJUI,AUD_new_PEFPBP,AUD_new_PEFPDG,AUD_new_PEFVBP,AUD_new_PEFVDG,AUD_new_PEIMPINTER,AUD_new_PEINGBRUTO,AUD_new_PEJUI,AUD_new_PENDOC,AUD_new_PENOM,AUD_new_PENORESPON,AUD_new_PENROBRUTO,AUD_new_PENROINTER,AUD_new_PEPAIS,AUD_new_PEPRES,AUD_new_PERESINSC,AUD_new_PERESNOINS,AUD_new_PERG2784,AUD_new_PERG3125,AUD_new_PERG3337,AUD_new_PESN01,AUD_new_PESN02,AUD_new_PESN03,AUD_new_PETDOC,AUD_new_PETIPO,AUD_new_PETIPOEMPR, AUD_old_PEBCEAJINF,AUD_old_PEBPS,AUD_old_PECONSFIN,AUD_old_PEDGI,AUD_old_PEEMB,AUD_old_PEEXENTO,AUD_old_PEFALT,AUD_old_PEFBAJ,AUD_old_PEFEMB,AUD_old_PEFJUI,AUD_old_PEFPBP,AUD_old_PEFPDG,AUD_old_PEFVBP,AUD_old_PEFVDG,AUD_old_PEIMPINTER,AUD_old_PEINGBRUTO,AUD_old_PEJUI,AUD_old_PENDOC,AUD_old_PENOM,AUD_old_PENORESPON,AUD_old_PENROBRUTO,AUD_old_PENROINTER,AUD_old_PEPAIS,AUD_old_PEPRES,AUD_old_PERESINSC,AUD_old_PERESNOINS,AUD_old_PERG2784,AUD_old_PERG3125,AUD_old_PERG3337,AUD_old_PESN01,AUD_old_PESN02,AUD_old_PESN03,AUD_old_PETDOC,AUD_old_PETIPO,AUD_old_PETIPOEMPR, AUD_FSD001_GuidKey ,AUD_FSD001_UOn,AUD_FSD001_UT ,AUD_FSD001_UBR ,AUD_FSD001_UBC ,AUD_FSD001_UBT ,AUD_FSD001_UBU ,AUD_FSD001_UBA ,AUD_FSD001_UBS ,AUD_FSD001_UBP ,AUD_FSD001_UBM ,AUD_FSD001_UAs )     VALUES (:new.PEBCEAJINF,:new.PEBPS,:new.PECONSFIN,:new.PEDGI,:new.PEEMB,:new.PEEXENTO,:new.PEFALT,:new.PEFBAJ,:new.PEFEMB,:new.PEFJUI,:new.PEFPBP,:new.PEFPDG,:new.PEFVBP,:new.PEFVDG,:new.PEIMPINTER,:new.PEINGBRUTO,:new.PEJUI,:new.PENDOC,:new.PENOM,:new.PENORESPON,:new.PENROBRUTO,:new.PENROINTER,:new.PEPAIS,:new.PEPRES,:new.PERESINSC,:new.PERESNOINS,:new.PERG2784,:new.PERG3125,:new.PERG3337,:new.PESN01,:new.PESN02,:new.PESN03,:new.PETDOC,:new.PETIPO,:new.PETIPOEMPR,  :old.PEBCEAJINF,:old.PEBPS,:old.PECONSFIN,:old.PEDGI,:old.PEEMB,:old.PEEXENTO,:old.PEFALT,:old.PEFBAJ,:old.PEFEMB,:old.PEFJUI,:old.PEFPBP,:old.PEFPDG,:old.PEFVBP,:old.PEFVDG,:old.PEIMPINTER,:old.PEINGBRUTO,:old.PEJUI,:old.PENDOC,:old.PENOM,:old.PENORESPON,:old.PENROBRUTO,:old.PENROINTER,:old.PEPAIS,:old.PEPRES,:old.PERESINSC,:old.PERESNOINS,:old.PERG2784,:old.PERG3125,:old.PERG3337,:old.PESN01,
:old.PESN02,:old.PESN03,:old.PETDOC,:old.PETIPO,:old.PETIPOEMPR,  SYS_GUID(),SYSTIMESTAMP,SYSTIMESTAMP,RequestNumber,ConnectionId,TransactionNumber,UserName,Application,Server,ProgramName,WrkstName,'U' ); END T_AUD_FSD001_AUD_U;
/

