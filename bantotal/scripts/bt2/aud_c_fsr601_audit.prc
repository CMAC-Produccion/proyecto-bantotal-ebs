CREATE OR REPLACE PROCEDURE AUD_C_FSR601_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FSR601_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'FSR601',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PP3COD=', RTRIM(COALESCE(AUD_old_PP3COD,AUD_new_PP3COD)) ),CONCAT( '|PP3CORR=', RTRIM(COALESCE(AUD_old_PP3CORR,AUD_new_PP3CORR)) ) ),CONCAT( '|PP3CTA=', RTRIM(COALESCE(AUD_old_PP3CTA,AUD_new_PP3CTA)) ) ),CONCAT( '|PP3MDA=', RTRIM(COALESCE(AUD_old_PP3MDA,AUD_new_PP3MDA)) ) ),CONCAT( '|PP3MOD=', RTRIM(COALESCE(AUD_old_PP3MOD,AUD_new_PP3MOD)) ) ),CONCAT( '|PP3OPER=', RTRIM(COALESCE(AUD_old_PP3OPER,AUD_new_PP3OPER)) ) ),CONCAT( '|PP3PAP=', RTRIM(COALESCE(AUD_old_PP3PAP,AUD_new_PP3PAP)) ) ),CONCAT( '|PP3SBOP=', RTRIM(COALESCE(AUD_old_PP3SBOP,AUD_new_PP3SBOP)) ) ),CONCAT( '|PP3SUC=', RTRIM(COALESCE(AUD_old_PP3SUC,AUD_new_PP3SUC)) ) ),CONCAT( '|PP3TOPE=', RTRIM(COALESCE(AUD_old_PP3TOPE,AUD_new_PP3TOPE)) ) ),'|' ),AUD_FSR601_UBT,AUD_FSR601_UBU,AUD_FSR601_UBM,AUD_FSR601_UBP,AUD_FSR601_UBR,AUD_FSR601_UAs,AUD_FSR601_UBC,AUD_FSR601_UBA,AUD_FSR601_UBS, '', 'BANTOTAL', '', '', '',AUD_FSR601_UT FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3COD',AUD_old_PP3COD,AUD_new_PP3COD FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3CORR',AUD_old_PP3CORR,AUD_new_PP3CORR FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3CORR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3CTA',AUD_old_PP3CTA,AUD_new_PP3CTA FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3CTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3MDA',AUD_old_PP3MDA,AUD_new_PP3MDA FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3MOD',AUD_old_PP3MOD,AUD_new_PP3MOD FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3OPER',AUD_old_PP3OPER,AUD_new_PP3OPER FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3OPER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3PAP',AUD_old_PP3PAP,AUD_new_PP3PAP FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3SBOP',AUD_old_PP3SBOP,AUD_new_PP3SBOP FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3SBOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3SUC',AUD_old_PP3SUC,AUD_new_PP3SUC FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 W
HERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3SUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP3TOPE',AUD_old_PP3TOPE,AUD_new_PP3TOPE FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP3TOPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4COD',AUD_old_PP4COD,AUD_new_PP4COD FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4CTA',AUD_old_PP4CTA,AUD_new_PP4CTA FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4CTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4MDA',AUD_old_PP4MDA,AUD_new_PP4MDA FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4MOD',AUD_old_PP4MOD,AUD_new_PP4MOD FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4OPER',AUD_old_PP4OPER,AUD_new_PP4OPER FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4OPER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4PAP',AUD_old_PP4PAP,AUD_new_PP4PAP FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4PARC',AUD_old_PP4PARC,AUD_new_PP4PARC FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4PARC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4SBOP',AUD_old_PP4SBOP,AUD_new_PP4SBOP FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4SBOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4SOBR',AUD_old_PP4SOBR,AUD_new_PP4SOBR FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4SOBR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4SUC',AUD_old_PP4SUC,AUD_new_PP4SUC FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4SUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSR601_UOn,AUD_FSR601_GuidKey,'PP4TOPE',AUD_old_PP4TOPE,AUD_new_PP4TOPE FROM BANTPROD.AUD_FSR601_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey AND AUDMstFld = 'PP4TOPE'); DELETE FROM AUD_FSR601_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSR601_UOn AND AUDMstId = AUD_FSR601_GuidKey);  COMMIT ;END IF;END;
/

