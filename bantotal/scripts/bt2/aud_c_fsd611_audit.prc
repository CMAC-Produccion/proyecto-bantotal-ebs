CREATE OR REPLACE PROCEDURE AUD_C_FSD611_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FSD611_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'FSD611',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|PGCOD=', RTRIM(COALESCE(AUD_old_PGCOD,AUD_new_PGCOD)) ),CONCAT( '|PPCTA=', RTRIM(COALESCE(AUD_old_PPCTA,AUD_new_PPCTA)) ) ),CONCAT( '|PPEXTE=', RTRIM(COALESCE(AUD_old_PPEXTE,AUD_new_PPEXTE)) ) ),CONCAT( '|PPFPAG=', RTRIM(COALESCE(AUD_old_PPFPAG,AUD_new_PPFPAG)) ) ),CONCAT( '|PPMDA=', RTRIM(COALESCE(AUD_old_PPMDA,AUD_new_PPMDA)) ) ),CONCAT( '|PPMOD=', RTRIM(COALESCE(AUD_old_PPMOD,AUD_new_PPMOD)) ) ),CONCAT( '|PPOPER=', RTRIM(COALESCE(AUD_old_PPOPER,AUD_new_PPOPER)) ) ),CONCAT( '|PPPAP=', RTRIM(COALESCE(AUD_old_PPPAP,AUD_new_PPPAP)) ) ),CONCAT( '|PPSBOP=', RTRIM(COALESCE(AUD_old_PPSBOP,AUD_new_PPSBOP)) ) ),CONCAT( '|PPSUC=', RTRIM(COALESCE(AUD_old_PPSUC,AUD_new_PPSUC)) ) ),CONCAT( '|PPTIPO=', RTRIM(COALESCE(AUD_old_PPTIPO,AUD_new_PPTIPO)) ) ),CONCAT( '|PPTOPE=', RTRIM(COALESCE(AUD_old_PPTOPE,AUD_new_PPTOPE)) ) ),'|' ),AUD_FSD611_UBT,AUD_FSD611_UBU,AUD_FSD611_UBM,AUD_FSD611_UBP,AUD_FSD611_UBR,AUD_FSD611_UAs,AUD_FSD611_UBC,AUD_FSD611_UBA,AUD_FSD611_UBS, '', 'BANTOTAL', '', '', '',AUD_FSD611_UT FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PGCOD',AUD_old_PGCOD,AUD_new_PGCOD FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PGCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPCTA',AUD_old_PPCTA,AUD_new_PPCTA FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPCTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPEXTE',AUD_old_PPEXTE,AUD_new_PPEXTE FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPEXTE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPFPAG',TO_CHAR(AUD_old_PPFPAG,'YYYY-MM-DD'),TO_CHAR(AUD_new_PPFPAG,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPFPAG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP1',AUD_old_PPIMP1,AUD_new_PPIMP1 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP10',AUD_old_PPIMP10,AUD_new_PPIMP10 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP10'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP11',AUD_old_PPIMP11,AUD_new_PPIMP11 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP11'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP12',AUD_old_PPIMP12,AUD_new_PPIMP12 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP12'); INSERT INTO BANTPROD.AUD
005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP13',AUD_old_PPIMP13,AUD_new_PPIMP13 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP13'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP14',AUD_old_PPIMP14,AUD_new_PPIMP14 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP14'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP15',AUD_old_PPIMP15,AUD_new_PPIMP15 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP15'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP16',AUD_old_PPIMP16,AUD_new_PPIMP16 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP16'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP17',AUD_old_PPIMP17,AUD_new_PPIMP17 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP17'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP18',AUD_old_PPIMP18,AUD_new_PPIMP18 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP18'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP19',AUD_old_PPIMP19,AUD_new_PPIMP19 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP19'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP2',AUD_old_PPIMP2,AUD_new_PPIMP2 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP20',AUD_old_PPIMP20,AUD_new_PPIMP20 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP20'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP3',AUD_old_PPIMP3,AUD_new_PPIMP3 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP4',AUD_old_PPIMP4,AUD_new_PPIMP4 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP4'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP5',AUD_old_PPIMP5,AUD_new_PPIMP5 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP5'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP6',AUD_old_PPIMP6,AUD_new_PPIMP6 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP6'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP7',AUD_old_PPIMP7,AUD_new_PPIMP7 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP7'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD6
11_GuidKey,'PPIMP8',AUD_old_PPIMP8,AUD_new_PPIMP8 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP8'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPIMP9',AUD_old_PPIMP9,AUD_new_PPIMP9 FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPIMP9'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPMDA',AUD_old_PPMDA,AUD_new_PPMDA FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPMDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPMOD',AUD_old_PPMOD,AUD_new_PPMOD FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPMOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPOPER',AUD_old_PPOPER,AUD_new_PPOPER FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPOPER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPPAP',AUD_old_PPPAP,AUD_new_PPPAP FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPPAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPSBOP',AUD_old_PPSBOP,AUD_new_PPSBOP FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPSBOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPSUC',AUD_old_PPSUC,AUD_new_PPSUC FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPSUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPTIPO',AUD_old_PPTIPO,AUD_new_PPTIPO FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPTIPO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD611_UOn,AUD_FSD611_GuidKey,'PPTOPE',AUD_old_PPTOPE,AUD_new_PPTOPE FROM BANTPROD.AUD_FSD611_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey AND AUDMstFld = 'PPTOPE'); DELETE FROM AUD_FSD611_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD611_UOn AND AUDMstId = AUD_FSD611_GuidKey);  COMMIT ;END IF;END;
/

