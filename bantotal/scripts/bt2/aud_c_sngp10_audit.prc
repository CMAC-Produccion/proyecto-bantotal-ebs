CREATE OR REPLACE PROCEDURE AUD_C_SNGP10_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_SNGP10_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|SNGP09COD=', RTRIM(COALESCE(AUD_old_SNGP09COD,AUD_new_SNGP09COD)) ),CONCAT( '|SNGP10MOD=', RTRIM(COALESCE(AUD_old_SNGP10MOD,AUD_new_SNGP10MOD)) ) ),CONCAT( '|SNGP10PGC=', RTRIM(COALESCE(AUD_old_SNGP10PGC,AUD_new_SNGP10PGC)) ) ),CONCAT( '|SNGP10TOPE=', RTRIM(COALESCE(AUD_old_SNGP10TOPE,AUD_new_SNGP10TOPE)) ) ),'|' ),AUD_SNGP10_UBT,AUD_SNGP10_UBU,AUD_SNGP10_UBM,AUD_SNGP10_UBP,AUD_SNGP10_UBR,AUD_SNGP10_UAs,AUD_SNGP10_UBC,AUD_SNGP10_UBA,AUD_SNGP10_UBS, '', 'BANTOTAL', '', '', '',AUD_SNGP10_UT FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP09COD',AUD_old_SNGP09COD,AUD_new_SNGP09COD FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP09COD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10CHR1',AUD_old_SNGP10CHR1,AUD_new_SNGP10CHR1 FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10CHR1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10CHR2',AUD_old_SNGP10CHR2,AUD_new_SNGP10CHR2 FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10CHR2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10CHR3',AUD_old_SNGP10CHR3,AUD_new_SNGP10CHR3 FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10CHR3'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10INT9',AUD_old_SNGP10INT9,AUD_new_SNGP10INT9 FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10INT9'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10LTCO',AUD_old_SNGP10LTCO,AUD_new_SNGP10LTCO FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10LTCO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10MOD',AUD_old_SNGP10MOD,AUD_new_SNGP10MOD FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10PGC',AUD_old_SNGP10PGC,AUD_new_SNGP10PGC FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10PGC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10PGM1',AUD_old_SNGP10PGM1,AUD_new_SNGP10PGM1 FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10PGM1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10PGM2',AUD_old_SNGP10PGM2,AUD_new_SNGP10PGM2 FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AN
D AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10PGM2'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10PROC',AUD_old_SNGP10PROC,AUD_new_SNGP10PROC FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10PROC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10RNG',AUD_old_SNGP10RNG,AUD_new_SNGP10RNG FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10RNG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10SINT',AUD_old_SNGP10SINT,AUD_new_SNGP10SINT FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10SINT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP10TOPE',AUD_old_SNGP10TOPE,AUD_new_SNGP10TOPE FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP10TOPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNGP10_UOn,AUD_SNGP10_GuidKey,'SNGP14COD',AUD_old_SNGP14COD,AUD_new_SNGP14COD FROM BANTPROD.AUD_SNGP10_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey AND AUDMstFld = 'SNGP14COD'); DELETE FROM AUD_SNGP10_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNGP10_UOn AND AUDMstId = AUD_SNGP10_GuidKey);  COMMIT ;END IF;END;
/

