CREATE OR REPLACE PROCEDURE AUD_C_JAQL716_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_JAQL716_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716',CONCAT( CONCAT( CONCAT( '|JAQL716IDRE=', RTRIM(COALESCE(AUD_old_JAQL716IDRE,AUD_new_JAQL716IDRE)) ),CONCAT( '|JAQL716INST=', RTRIM(COALESCE(AUD_old_JAQL716INST,AUD_new_JAQL716INST)) ) ),'|' ),AUD_JAQL716_UBT,AUD_JAQL716_UBU,AUD_JAQL716_UBM,AUD_JAQL716_UBP,AUD_JAQL716_UBR,AUD_JAQL716_UAs,AUD_JAQL716_UBC,AUD_JAQL716_UBA,AUD_JAQL716_UBS, '', 'BANTOTAL', '', '', '',AUD_JAQL716_UT FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU01',AUD_old_JAQL716AU01,AUD_new_JAQL716AU01 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU01'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU02',AUD_old_JAQL716AU02,AUD_new_JAQL716AU02 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU02'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU03',AUD_old_JAQL716AU03,AUD_new_JAQL716AU03 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU03'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU04',AUD_old_JAQL716AU04,AUD_new_JAQL716AU04 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU04'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU05',AUD_old_JAQL716AU05,AUD_new_JAQL716AU05 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU05'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU06',AUD_old_JAQL716AU06,AUD_new_JAQL716AU06 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU06'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU07',AUD_old_JAQL716AU07,AUD_new_JAQL716AU07 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU07'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU08',AUD_old_JAQL716AU08,AUD_new_JAQL716AU08 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU08'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU09',AUD_old_JAQL716AU09,AUD_new_JAQL716AU09 FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU09'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU10',TO_CHAR(AUD_old_JAQL716AU10,'YYYY-MM-DD'),TO_CHAR(AUD_new_JAQL716AU10,'YYYY-MM-DD') FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUD
MstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU10'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU11',TO_CHAR(AUD_old_JAQL716AU11,'YYYY-MM-DD'),TO_CHAR(AUD_new_JAQL716AU11,'YYYY-MM-DD') FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU11'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716AU12',TO_CHAR(AUD_old_JAQL716AU12,'YYYY-MM-DD'),TO_CHAR(AUD_new_JAQL716AU12,'YYYY-MM-DD') FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716AU12'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716ESTA',AUD_old_JAQL716ESTA,AUD_new_JAQL716ESTA FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716ESTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716FECH',TO_CHAR(AUD_old_JAQL716FECH,'YYYY-MM-DD'),TO_CHAR(AUD_new_JAQL716FECH,'YYYY-MM-DD') FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716FECH'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716HORA',AUD_old_JAQL716HORA,AUD_new_JAQL716HORA FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716HORA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716IDRE',AUD_old_JAQL716IDRE,AUD_new_JAQL716IDRE FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716IDRE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716INST',AUD_old_JAQL716INST,AUD_new_JAQL716INST FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716INST'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716SUCU',AUD_old_JAQL716SUCU,AUD_new_JAQL716SUCU FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716SUCU'); INSERT INTO BANTPROD.AUD005 SELECT AUD_JAQL716_UOn,AUD_JAQL716_GuidKey,'JAQL716USER',AUD_old_JAQL716USER,AUD_new_JAQL716USER FROM BANTPROD.AUD_JAQL716_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey AND AUDMstFld = 'JAQL716USER'); DELETE FROM AUD_JAQL716_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_JAQL716_UOn AND AUDMstId = AUD_JAQL716_GuidKey);  COMMIT ;END IF;END;
/

