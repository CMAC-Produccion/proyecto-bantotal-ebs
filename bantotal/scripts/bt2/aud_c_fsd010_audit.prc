CREATE OR REPLACE PROCEDURE AUD_C_FSD010_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_FSD010_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'FSD010',CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( CONCAT( '|AOCTA=', RTRIM(COALESCE(AUD_old_AOCTA,AUD_new_AOCTA)) ),CONCAT( '|AOMDA=', RTRIM(COALESCE(AUD_old_AOMDA,AUD_new_AOMDA)) ) ),CONCAT( '|AOMOD=', RTRIM(COALESCE(AUD_old_AOMOD,AUD_new_AOMOD)) ) ),CONCAT( '|AOOPER=', RTRIM(COALESCE(AUD_old_AOOPER,AUD_new_AOOPER)) ) ),CONCAT( '|AOPAP=', RTRIM(COALESCE(AUD_old_AOPAP,AUD_new_AOPAP)) ) ),CONCAT( '|AOSBOP=', RTRIM(COALESCE(AUD_old_AOSBOP,AUD_new_AOSBOP)) ) ),CONCAT( '|AOSUC=', RTRIM(COALESCE(AUD_old_AOSUC,AUD_new_AOSUC)) ) ),CONCAT( '|AOTOPE=', RTRIM(COALESCE(AUD_old_AOTOPE,AUD_new_AOTOPE)) ) ),CONCAT( '|PGCOD=', RTRIM(COALESCE(AUD_old_PGCOD,AUD_new_PGCOD)) ) ),'|' ),AUD_FSD010_UBT,AUD_FSD010_UBU,AUD_FSD010_UBM,AUD_FSD010_UBP,AUD_FSD010_UBR,AUD_FSD010_UAs,AUD_FSD010_UBC,AUD_FSD010_UBA,AUD_FSD010_UBS, '', 'BANTOTAL', '', '', '',AUD_FSD010_UT FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOAFIV',AUD_old_AOAFIV,AUD_new_AOAFIV FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOAFIV'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOARB',AUD_old_AOARB,AUD_new_AOARB FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOARB'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOARB1',AUD_old_AOARB1,AUD_new_AOARB1 FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOARB1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOAVIS',AUD_old_AOAVIS,AUD_new_AOAVIS FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOAVIS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOCBCU',AUD_old_AOCBCU,AUD_new_AOCBCU FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOCBCU'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOCLTCOD',AUD_old_AOCLTCOD,AUD_new_AOCLTCOD FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOCLTCOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOCTA',AUD_old_AOCTA,AUD_new_AOCTA FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOCTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AODREV',AUD_old_AODREV,AUD_new_AODREV FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AODREV'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOEVEN',AUD_old_AOEVEN,AUD_new_AOEVEN FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOEVEN'); INSERT INTO BANTPROD.AUD005
SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOFE99',TO_CHAR(AUD_old_AOFE99,'YYYY-MM-DD'),TO_CHAR(AUD_new_AOFE99,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOFE99'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOFNUM',TO_CHAR(AUD_old_AOFNUM,'YYYY-MM-DD'),TO_CHAR(AUD_new_AOFNUM,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOFNUM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOFVAL',TO_CHAR(AUD_old_AOFVAL,'YYYY-MM-DD'),TO_CHAR(AUD_new_AOFVAL,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOFVAL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOFVTO',TO_CHAR(AUD_old_AOFVTO,'YYYY-MM-DD'),TO_CHAR(AUD_new_AOFVTO,'YYYY-MM-DD') FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOFVTO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOIMP',AUD_old_AOIMP,AUD_new_AOIMP FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOIMP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOMD',AUD_old_AOMD,AUD_new_AOMD FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOMD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOMD1',AUD_old_AOMD1,AUD_new_AOMD1 FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOMD1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOMDA',AUD_old_AOMDA,AUD_new_AOMDA FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOMDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOMOD',AUD_old_AOMOD,AUD_new_AOMOD FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOMOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AONUME',AUD_old_AONUME,AUD_new_AONUME FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AONUME'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOOPER',AUD_old_AOOPER,AUD_new_AOOPER FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOOPER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOPAP',AUD_old_AOPAP,AUD_new_AOPAP FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOPAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOPERIOD',AUD_old_AOPERIOD,AUD_new_AOPERIOD FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOPERIOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOPLUS',AUD_old_AOPLUS,AUD_new_AOPLUS FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn
 AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOPLUS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOPRE',AUD_old_AOPRE,AUD_new_AOPRE FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOPRE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOPRE1',AUD_old_AOPRE1,AUD_new_AOPRE1 FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOPRE1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOPZO',AUD_old_AOPZO,AUD_new_AOPZO FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOPZO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOSBOP',AUD_old_AOSBOP,AUD_new_AOSBOP FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOSBOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOSTAT',AUD_old_AOSTAT,AUD_new_AOSTAT FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOSTAT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOSUC',AUD_old_AOSUC,AUD_new_AOSUC FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOSUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTANO',AUD_old_AOTANO,AUD_new_AOTANO FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTANO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTASA',AUD_old_AOTASA,AUD_new_AOTASA FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTASA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTASC',AUD_old_AOTASC,AUD_new_AOTASC FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTASC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTCBI',AUD_old_AOTCBI,AUD_new_AOTCBI FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTCBI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTCBI1',AUD_old_AOTCBI1,AUD_new_AOTCBI1 FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTCBI1'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTDIA',AUD_old_AOTDIA,AUD_new_AOTDIA FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTDIA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTINT',AUD_old_AOTINT,AUD_new_AOTINT FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTINT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTMOR',AUD_old_AOTMOR,AUD_new_AOTMOR FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTMOR'); INSERT INTO 
BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTOPE',AUD_old_AOTOPE,AUD_new_AOTOPE FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTOPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTTAC',AUD_old_AOTTAC,AUD_new_AOTTAC FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTTAC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTTAS',AUD_old_AOTTAS,AUD_new_AOTTAS FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTTAS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'AOTVTO',AUD_old_AOTVTO,AUD_new_AOTVTO FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'AOTVTO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_FSD010_UOn,AUD_FSD010_GuidKey,'PGCOD',AUD_old_PGCOD,AUD_new_PGCOD FROM BANTPROD.AUD_FSD010_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey AND AUDMstFld = 'PGCOD'); DELETE FROM AUD_FSD010_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_FSD010_UOn AND AUDMstId = AUD_FSD010_GuidKey);  COMMIT ;END IF;END;
/

