CREATE OR REPLACE PROCEDURE AUD_C_SNG122_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_SNG122_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122',CONCAT( CONCAT( CONCAT( '|SNG122CORR=', RTRIM(COALESCE(AUD_old_SNG122CORR,AUD_new_SNG122CORR)) ),CONCAT( '|SNG122INST=', RTRIM(COALESCE(AUD_old_SNG122INST,AUD_new_SNG122INST)) ) ),'|' ),AUD_SNG122_UBT,AUD_SNG122_UBU,AUD_SNG122_UBM,AUD_SNG122_UBP,AUD_SNG122_UBR,AUD_SNG122_UAs,AUD_SNG122_UBC,AUD_SNG122_UBA,AUD_SNG122_UBS, '', 'BANTOTAL', '', '', '',AUD_SNG122_UT FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122AUXC',AUD_old_SNG122AUXC,AUD_new_SNG122AUXC FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122AUXC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122CORR',AUD_old_SNG122CORR,AUD_new_SNG122CORR FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122CORR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122CTA',AUD_old_SNG122CTA,AUD_new_SNG122CTA FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122CTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122FAPE',TO_CHAR(AUD_old_SNG122FAPE,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNG122FAPE,'YYYY-MM-DD') FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122FAPE'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122INST',AUD_old_SNG122INST,AUD_new_SNG122INST FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122INST'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122MDA',AUD_old_SNG122MDA,AUD_new_SNG122MDA FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122MOD',AUD_old_SNG122MOD,AUD_new_SNG122MOD FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122MTOD',AUD_old_SNG122MTOD,AUD_new_SNG122MTOD FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122MTOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122MTOU',AUD_old_SNG122MTOU,AUD_new_SNG122MTOU FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122MTOU'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122OPER',AUD_old_SNG122OPER,AUD_new_SNG122OPER FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122OPER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidK
ey,'SNG122PAP',AUD_old_SNG122PAP,AUD_new_SNG122PAP FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122PGC',AUD_old_SNG122PGC,AUD_new_SNG122PGC FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122PGC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122POCO',AUD_old_SNG122POCO,AUD_new_SNG122POCO FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122POCO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122PRI',AUD_old_SNG122PRI,AUD_new_SNG122PRI FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122PRI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122SBOP',AUD_old_SNG122SBOP,AUD_new_SNG122SBOP FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122SBOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122SDOG',AUD_old_SNG122SDOG,AUD_new_SNG122SDOG FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122SDOG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122SUC',AUD_old_SNG122SUC,AUD_new_SNG122SUC FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122SUC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122TCBI',AUD_old_SNG122TCBI,AUD_new_SNG122TCBI FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122TCBI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122TIPO',AUD_old_SNG122TIPO,AUD_new_SNG122TIPO FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122TIPO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG122_UOn,AUD_SNG122_GuidKey,'SNG122TOPE',AUD_old_SNG122TOPE,AUD_new_SNG122TOPE FROM BANTPROD.AUD_SNG122_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey AND AUDMstFld = 'SNG122TOPE'); DELETE FROM AUD_SNG122_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNG122_UOn AND AUDMstId = AUD_SNG122_GuidKey);  COMMIT ;END IF;END;
/

