CREATE OR REPLACE PROCEDURE AUD_C_SNG120_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_SNG120_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120',CONCAT( CONCAT( CONCAT( '|SNG120INS=', RTRIM(COALESCE(AUD_old_SNG120INS,AUD_new_SNG120INS)) ),CONCAT( '|SNG120TSK=', RTRIM(COALESCE(AUD_old_SNG120TSK,AUD_new_SNG120TSK)) ) ),'|' ),AUD_SNG120_UBT,AUD_SNG120_UBU,AUD_SNG120_UBM,AUD_SNG120_UBP,AUD_SNG120_UBR,AUD_SNG120_UAs,AUD_SNG120_UBC,AUD_SNG120_UBA,AUD_SNG120_UBS, '', 'BANTOTAL', '', '', '',AUD_SNG120_UT FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120CLIQ',AUD_old_SNG120CLIQ,AUD_new_SNG120CLIQ FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120CLIQ'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120CLTA',AUD_old_SNG120CLTA,AUD_new_SNG120CLTA FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120CLTA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120CUO',AUD_old_SNG120CUO,AUD_new_SNG120CUO FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120CUO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120FPAG',TO_CHAR(AUD_old_SNG120FPAG,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNG120FPAG,'YYYY-MM-DD') FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120FPAG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120FVAL',TO_CHAR(AUD_old_SNG120FVAL,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNG120FVAL,'YYYY-MM-DD') FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120FVAL'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120FVTO',TO_CHAR(AUD_old_SNG120FVTO,'YYYY-MM-DD'),TO_CHAR(AUD_new_SNG120FVTO,'YYYY-MM-DD') FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120FVTO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120INS',AUD_old_SNG120INS,AUD_new_SNG120INS FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120INS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120MCR',AUD_old_SNG120MCR,AUD_new_SNG120MCR FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120MCR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120MDA',AUD_old_SNG120MDA,AUD_new_SNG120MDA FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120MDA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120MOD',AUD_old_SNG120MOD,AUD_new_SNG120MOD FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG12
0MOD'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120MTO',AUD_old_SNG120MTO,AUD_new_SNG120MTO FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120MTO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120PAP',AUD_old_SNG120PAP,AUD_new_SNG120PAP FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120PAP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120PER',AUD_old_SNG120PER,AUD_new_SNG120PER FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120PER'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120PLUS',AUD_old_SNG120PLUS,AUD_new_SNG120PLUS FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120PLUS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120PZO',AUD_old_SNG120PZO,AUD_new_SNG120PZO FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120PZO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120TASA',AUD_old_SNG120TASA,AUD_new_SNG120TASA FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120TASA'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120TCBI',AUD_old_SNG120TCBI,AUD_new_SNG120TCBI FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120TCBI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120TOP',AUD_old_SNG120TOP,AUD_new_SNG120TOP FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120TOP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120TSK',AUD_old_SNG120TSK,AUD_new_SNG120TSK FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120TSK'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120TTAS',AUD_old_SNG120TTAS,AUD_new_SNG120TTAS FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120TTAS'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120VCUO',AUD_old_SNG120VCUO,AUD_new_SNG120VCUO FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120VCUO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_SNG120_UOn,AUD_SNG120_GuidKey,'SNG120XML',AUD_old_SNG120XML,AUD_new_SNG120XML FROM BANTPROD.AUD_SNG120_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey AND AUDMstFld = 'SNG120XML'); DELETE FROM AUD_SNG120_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_SNG120_UOn AND AUDMstId = AUD_SNG120_GuidKey);  COMMIT ;END IF;END;
/

