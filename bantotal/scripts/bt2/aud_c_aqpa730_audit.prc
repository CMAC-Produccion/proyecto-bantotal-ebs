CREATE OR REPLACE PROCEDURE AUD_C_AQPA730_AUDIT AS cnt NUMBER; BEGIN SELECT COUNT(*) INTO cnt FROM BANTPROD.AUD_AQPA730_AUDIT; IF( cnt > 0 ) THEN INSERT INTO BANTPROD.AUD004 (AUDMstTim, AUDMstId, AUDMstTbl, AUDMstKey, AUDMstTrn, AUDMstUsr, AUDMstWst, AUDMstPgm, AUDMstReq, AUDMstTyp, AUDMstCon, AUDMstApp, AUDMstSrv, AUDMstSes, AUDMstGrp, AUDMstLog, AUDMstCur, AUDMstSnt,AUDMstTic) SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730',CONCAT( CONCAT( '|AQPA730ID=', RTRIM(COALESCE(AUD_old_AQPA730ID,AUD_new_AQPA730ID)) ),'|' ),AUD_AQPA730_UBT,AUD_AQPA730_UBU,AUD_AQPA730_UBM,AUD_AQPA730_UBP,AUD_AQPA730_UBR,AUD_AQPA730_UAs,AUD_AQPA730_UBC,AUD_AQPA730_UBA,AUD_AQPA730_UBS, '', 'BANTOTAL', '', '', '',AUD_AQPA730_UT FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730ACTION',AUD_old_AQPA730ACTION,AUD_new_AQPA730ACTION FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730ACTION'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730ACTIONBT',AUD_old_AQPA730ACTIONBT,AUD_new_AQPA730ACTIONBT FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730ACTIONBT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730CHNCAR',AUD_old_AQPA730CHNCAR,AUD_new_AQPA730CHNCAR FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730CHNCAR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730EVENTO',AUD_old_AQPA730EVENTO,AUD_new_AQPA730EVENTO FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730EVENTO'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730EVENTOBT',AUD_old_AQPA730EVENTOBT,AUD_new_AQPA730EVENTOBT FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730EVENTOBT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730FECACT',TO_CHAR(AUD_old_AQPA730FECACT,'YYYY-MM-DD'),TO_CHAR(AUD_new_AQPA730FECACT,'YYYY-MM-DD') FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730FECACT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730FECBT',TO_CHAR(AUD_old_AQPA730FECBT,'YYYY-MM-DD'),TO_CHAR(AUD_new_AQPA730FECBT,'YYYY-MM-DD') FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730FECBT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730FECCAR',TO_CHAR(AUD_old_AQPA730FECCAR,'YYYY-MM-DD'),TO_CHAR(AUD_new_AQPA730FECCAR,'YYYY-MM-DD') FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730FECCAR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730FECREG',TO_CHAR(AUD_old_AQPA730FECREG,'YYYY-MM-DD'),TO_CHAR(AUD_new_AQPA730FECREG,'YYYY-MM-DD') FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730FECREG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730HORACT',AUD_old_AQPA730HORACT,AUD_new_AQPA730HORACT
 FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730HORACT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730HORBT',AUD_old_AQPA730HORBT,AUD_new_AQPA730HORBT FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730HORBT'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730HORCAR',AUD_old_AQPA730HORCAR,AUD_new_AQPA730HORCAR FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730HORCAR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730HORREG',AUD_old_AQPA730HORREG,AUD_new_AQPA730HORREG FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730HORREG'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730ID',AUD_old_AQPA730ID,AUD_new_AQPA730ID FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730ID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730NUMDOC',AUD_old_AQPA730NUMDOC,AUD_new_AQPA730NUMDOC FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730NUMDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730NUMTAR',AUD_old_AQPA730NUMTAR,AUD_new_AQPA730NUMTAR FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730NUMTAR'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730PAIDOC',AUD_old_AQPA730PAIDOC,AUD_new_AQPA730PAIDOC FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730PAIDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730TARORI',AUD_old_AQPA730TARORI,AUD_new_AQPA730TARORI FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TARORI'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730TIPDOC',AUD_old_AQPA730TIPDOC,AUD_new_AQPA730TIPDOC FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TIPDOC'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730TOKEN',AUD_old_AQPA730TOKEN,AUD_new_AQPA730TOKEN FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TOKEN'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730TOKEXP',AUD_old_AQPA730TOKEXP,AUD_new_AQPA730TOKEXP FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TOKEXP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730TOKREFID',AUD_old_AQPA730TOKREFID,AUD_new_AQPA730TOKREFID FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TOKREFID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_G
uidKey,'AQPA730TOKREQID',AUD_old_AQPA730TOKREQID,AUD_new_AQPA730TOKREQID FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TOKREQID'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730TOKREQNAM',AUD_old_AQPA730TOKREQNAM,AUD_new_AQPA730TOKREQNAM FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TOKREQNAM'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730TOKTYP',AUD_old_AQPA730TOKTYP,AUD_new_AQPA730TOKTYP FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730TOKTYP'); INSERT INTO BANTPROD.AUD005 SELECT AUD_AQPA730_UOn,AUD_AQPA730_GuidKey,'AQPA730ULTEVE',AUD_old_AQPA730ULTEVE,AUD_new_AQPA730ULTEVE FROM BANTPROD.AUD_AQPA730_AUDIT WHERE NOT EXISTS (SELECT * FROM BANTPROD.AUD005 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey AND AUDMstFld = 'AQPA730ULTEVE'); DELETE FROM AUD_AQPA730_AUDIT  WHERE  EXISTS (SELECT * FROM BANTPROD.AUD004 WHERE AUDMstTim = AUD_AQPA730_UOn AND AUDMstId = AUD_AQPA730_GuidKey);  COMMIT ;END IF;END;
/

